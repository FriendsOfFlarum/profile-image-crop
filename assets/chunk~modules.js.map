{"version":3,"file":"chunk~modules.js","mappings":"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","sources":["webpack://@fof/profile-image-crop/./node_modules/cropperjs/dist/cropper.js","webpack://@fof/profile-image-crop/./node_modules/image-blob-reduce/dist/image-blob-reduce.esm.mjs"],"sourcesContent":["/*!\n * Cropper.js v1.5.13\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2022-11-20T05:30:46.114Z\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Cropper = factory());\n})(this, (function () { 'use strict';\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      enumerableOnly && (symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      })), keys.push.apply(keys, symbols);\n    }\n    return keys;\n  }\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = null != arguments[i] ? arguments[i] : {};\n      i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n    return target;\n  }\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n      return typeof obj;\n    } : function (obj) {\n      return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    }, _typeof(obj);\n  }\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n  }\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n  }\n  function _iterableToArray(iter) {\n    if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n  }\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n    return arr2;\n  }\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'cropper';\n\n  // Actions\n  var ACTION_ALL = 'all';\n  var ACTION_CROP = 'crop';\n  var ACTION_MOVE = 'move';\n  var ACTION_ZOOM = 'zoom';\n  var ACTION_EAST = 'e';\n  var ACTION_WEST = 'w';\n  var ACTION_SOUTH = 's';\n  var ACTION_NORTH = 'n';\n  var ACTION_NORTH_EAST = 'ne';\n  var ACTION_NORTH_WEST = 'nw';\n  var ACTION_SOUTH_EAST = 'se';\n  var ACTION_SOUTH_WEST = 'sw';\n\n  // Classes\n  var CLASS_CROP = \"\".concat(NAMESPACE, \"-crop\");\n  var CLASS_DISABLED = \"\".concat(NAMESPACE, \"-disabled\");\n  var CLASS_HIDDEN = \"\".concat(NAMESPACE, \"-hidden\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_MODAL = \"\".concat(NAMESPACE, \"-modal\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n\n  // Data keys\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\");\n  var DATA_PREVIEW = \"\".concat(NAMESPACE, \"Preview\");\n\n  // Drag modes\n  var DRAG_MODE_CROP = 'crop';\n  var DRAG_MODE_MOVE = 'move';\n  var DRAG_MODE_NONE = 'none';\n\n  // Events\n  var EVENT_CROP = 'crop';\n  var EVENT_CROP_END = 'cropend';\n  var EVENT_CROP_MOVE = 'cropmove';\n  var EVENT_CROP_START = 'cropstart';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_READY = 'ready';\n  var EVENT_RESIZE = 'resize';\n  var EVENT_WHEEL = 'wheel';\n  var EVENT_ZOOM = 'zoom';\n\n  // Mime types\n  var MIME_TYPE_JPEG = 'image/jpeg';\n\n  // RegExps\n  var REGEXP_ACTIONS = /^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/;\n  var REGEXP_DATA_URL = /^data:/;\n  var REGEXP_DATA_URL_JPEG = /^data:image\\/jpeg;base64,/;\n  var REGEXP_TAG_NAME = /^img|canvas$/i;\n\n  // Misc\n  // Inspired by the default width and height of a canvas element.\n  var MIN_CONTAINER_WIDTH = 200;\n  var MIN_CONTAINER_HEIGHT = 100;\n\n  var DEFAULTS = {\n    // Define the view mode of the cropper\n    viewMode: 0,\n    // 0, 1, 2, 3\n\n    // Define the dragging mode of the cropper\n    dragMode: DRAG_MODE_CROP,\n    // 'crop', 'move' or 'none'\n\n    // Define the initial aspect ratio of the crop box\n    initialAspectRatio: NaN,\n    // Define the aspect ratio of the crop box\n    aspectRatio: NaN,\n    // An object with the previous cropping result data\n    data: null,\n    // A selector for adding extra containers to preview\n    preview: '',\n    // Re-render the cropper when resize the window\n    responsive: true,\n    // Restore the cropped area after resize the window\n    restore: true,\n    // Check if the current image is a cross-origin image\n    checkCrossOrigin: true,\n    // Check the current image's Exif Orientation information\n    checkOrientation: true,\n    // Show the black modal\n    modal: true,\n    // Show the dashed lines for guiding\n    guides: true,\n    // Show the center indicator for guiding\n    center: true,\n    // Show the white modal to highlight the crop box\n    highlight: true,\n    // Show the grid background\n    background: true,\n    // Enable to crop the image automatically when initialize\n    autoCrop: true,\n    // Define the percentage of automatic cropping area when initializes\n    autoCropArea: 0.8,\n    // Enable to move the image\n    movable: true,\n    // Enable to rotate the image\n    rotatable: true,\n    // Enable to scale the image\n    scalable: true,\n    // Enable to zoom the image\n    zoomable: true,\n    // Enable to zoom the image by dragging touch\n    zoomOnTouch: true,\n    // Enable to zoom the image by wheeling mouse\n    zoomOnWheel: true,\n    // Define zoom ratio when zoom the image by wheeling mouse\n    wheelZoomRatio: 0.1,\n    // Enable to move the crop box\n    cropBoxMovable: true,\n    // Enable to resize the crop box\n    cropBoxResizable: true,\n    // Toggle drag mode between \"crop\" and \"move\" when click twice on the cropper\n    toggleDragModeOnDblclick: true,\n    // Size limitation\n    minCanvasWidth: 0,\n    minCanvasHeight: 0,\n    minCropBoxWidth: 0,\n    minCropBoxHeight: 0,\n    minContainerWidth: MIN_CONTAINER_WIDTH,\n    minContainerHeight: MIN_CONTAINER_HEIGHT,\n    // Shortcuts of events\n    ready: null,\n    cropstart: null,\n    cropmove: null,\n    cropend: null,\n    crop: null,\n    zoom: null\n  };\n\n  var TEMPLATE = '<div class=\"cropper-container\" touch-action=\"none\">' + '<div class=\"cropper-wrap-box\">' + '<div class=\"cropper-canvas\"></div>' + '</div>' + '<div class=\"cropper-drag-box\"></div>' + '<div class=\"cropper-crop-box\">' + '<span class=\"cropper-view-box\"></span>' + '<span class=\"cropper-dashed dashed-h\"></span>' + '<span class=\"cropper-dashed dashed-v\"></span>' + '<span class=\"cropper-center\"></span>' + '<span class=\"cropper-face\"></span>' + '<span class=\"cropper-line line-e\" data-cropper-action=\"e\"></span>' + '<span class=\"cropper-line line-n\" data-cropper-action=\"n\"></span>' + '<span class=\"cropper-line line-w\" data-cropper-action=\"w\"></span>' + '<span class=\"cropper-line line-s\" data-cropper-action=\"s\"></span>' + '<span class=\"cropper-point point-e\" data-cropper-action=\"e\"></span>' + '<span class=\"cropper-point point-n\" data-cropper-action=\"n\"></span>' + '<span class=\"cropper-point point-w\" data-cropper-action=\"w\"></span>' + '<span class=\"cropper-point point-s\" data-cropper-action=\"s\"></span>' + '<span class=\"cropper-point point-ne\" data-cropper-action=\"ne\"></span>' + '<span class=\"cropper-point point-nw\" data-cropper-action=\"nw\"></span>' + '<span class=\"cropper-point point-sw\" data-cropper-action=\"sw\"></span>' + '<span class=\"cropper-point point-se\" data-cropper-action=\"se\"></span>' + '</div>' + '</div>';\n\n  /**\n   * Check if the given value is not a number.\n   */\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n\n  /**\n   * Check if the given value is a positive number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a positive number, else `false`.\n   */\n  var isPositiveNumber = function isPositiveNumber(value) {\n    return value > 0 && value < Infinity;\n  };\n\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  var slice = Array.prototype.slice;\n\n  /**\n   * Convert array-like or iterable object to an array.\n   * @param {*} value - The value to convert.\n   * @returns {Array} Returns a new array.\n   */\n  function toArray(value) {\n    return Array.from ? Array.from(value) : slice.call(value);\n  }\n\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length) /* array-like */) {\n        toArray(data).forEach(function (value, key) {\n          callback.call(data, value, key, data);\n        });\n      } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n    return data;\n  }\n\n  /**\n   * Extend the given object.\n   * @param {*} target - The target object to extend.\n   * @param {*} args - The rest objects for merging to the target object.\n   * @returns {Object} The extended object.\n   */\n  var assign = Object.assign || function assign(target) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    if (isObject(target) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            target[key] = arg[key];\n          });\n        }\n      });\n    }\n    return target;\n  };\n  var REGEXP_DECIMALS = /\\.\\d*(?:0|9){12}\\d*$/;\n\n  /**\n   * Normalize decimal number.\n   * Check out {@link https://0.30000000000000004.com/}\n   * @param {number} value - The value to normalize.\n   * @param {number} [times=100000000000] - The times for normalizing.\n   * @returns {number} Returns the normalized number.\n   */\n  function normalizeDecimalNumber(value) {\n    var times = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100000000000;\n    return REGEXP_DECIMALS.test(value) ? Math.round(value * times) / times : value;\n  }\n  var REGEXP_SUFFIX = /^width|height|left|top|marginLeft|marginTop$/;\n\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value = \"\".concat(value, \"px\");\n      }\n      style[property] = value;\n    });\n  }\n\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n  function hasClass(element, value) {\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n  function addClass(element, value) {\n    if (!value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n    var className = element.className.trim();\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n  function removeClass(element, value) {\n    if (!value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    }\n\n    // IE10-11 doesn't support the second parameter of `classList.toggle`\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n  var REGEXP_CAMEL_CASE = /([a-z\\d])([A-Z])/g;\n\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n  function toParamCase(value) {\n    return value.replace(REGEXP_CAMEL_CASE, '$1-$2').toLowerCase();\n  }\n\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n    return element.getAttribute(\"data-\".concat(toParamCase(name)));\n  }\n\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(toParamCase(name)), data);\n    }\n  }\n\n  /**\n   * Remove data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to remove.\n   */\n  function removeData(element, name) {\n    if (isObject(element[name])) {\n      try {\n        delete element[name];\n      } catch (error) {\n        element[name] = undefined;\n      }\n    } else if (element.dataset) {\n      // #128 Safari not allows to delete dataset property\n      try {\n        delete element.dataset[name];\n      } catch (error) {\n        element.dataset[name] = undefined;\n      }\n    } else {\n      element.removeAttribute(\"data-\".concat(toParamCase(name)));\n    }\n  }\n  var REGEXP_SPACES = /\\s\\s*/;\n  var onceSupported = function () {\n    var supported = false;\n    if (IS_BROWSER) {\n      var once = false;\n      var listener = function listener() {};\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n    return supported;\n  }();\n\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n      element.removeEventListener(event, handler, options);\n    });\n  }\n\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n          listeners = _element$listeners === void 0 ? {} : _element$listeners;\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n          listener.apply(element, args);\n        };\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n      element.addEventListener(event, _handler, options);\n    });\n  }\n\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n  function dispatchEvent(element, type, data) {\n    var event;\n\n    // Event and CustomEvent on IE9-11 are global objects, not constructors\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, {\n        detail: data,\n        bubbles: true,\n        cancelable: true\n      });\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n    return element.dispatchEvent(event);\n  }\n\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  var location = WINDOW.location;\n  var REGEXP_ORIGINS = /^(\\w+:)\\/\\/([^:/?#]*):?(\\d*)/i;\n\n  /**\n   * Check if the given URL is a cross origin URL.\n   * @param {string} url - The target URL.\n   * @returns {boolean} Returns `true` if the given URL is a cross origin URL, else `false`.\n   */\n  function isCrossOriginURL(url) {\n    var parts = url.match(REGEXP_ORIGINS);\n    return parts !== null && (parts[1] !== location.protocol || parts[2] !== location.hostname || parts[3] !== location.port);\n  }\n\n  /**\n   * Add timestamp to the given URL.\n   * @param {string} url - The target URL.\n   * @returns {string} The result URL.\n   */\n  function addTimestamp(url) {\n    var timestamp = \"timestamp=\".concat(new Date().getTime());\n    return url + (url.indexOf('?') === -1 ? '?' : '&') + timestamp;\n  }\n\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n      scaleX = _ref.scaleX,\n      scaleY = _ref.scaleY,\n      translateX = _ref.translateX,\n      translateY = _ref.translateY;\n    var values = [];\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    }\n\n    // Rotate should come first before scale to match orientation transform\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n    var maxRatio = 0;\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        if (Math.abs(ratio) > Math.abs(maxRatio)) {\n          maxRatio = ratio;\n        }\n      });\n    });\n    return maxRatio;\n  }\n\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n      pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n        startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  /**\n   * Get the max sizes in a rectangle under the given aspect ratio.\n   * @param {Object} data - The original sizes.\n   * @param {string} [type='contain'] - The adjust type.\n   * @returns {Object} The result sizes.\n   */\n  function getAdjustedSizes(_ref4) {\n    var aspectRatio = _ref4.aspectRatio,\n      height = _ref4.height,\n      width = _ref4.width;\n    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'contain';\n    var isValidWidth = isPositiveNumber(width);\n    var isValidHeight = isPositiveNumber(height);\n    if (isValidWidth && isValidHeight) {\n      var adjustedWidth = height * aspectRatio;\n      if (type === 'contain' && adjustedWidth > width || type === 'cover' && adjustedWidth < width) {\n        height = width / aspectRatio;\n      } else {\n        width = height * aspectRatio;\n      }\n    } else if (isValidWidth) {\n      height = width / aspectRatio;\n    } else if (isValidHeight) {\n      width = height * aspectRatio;\n    }\n    return {\n      width: width,\n      height: height\n    };\n  }\n\n  /**\n   * Get the new sizes of a rectangle after rotated.\n   * @param {Object} data - The original sizes.\n   * @returns {Object} The result sizes.\n   */\n  function getRotatedSizes(_ref5) {\n    var width = _ref5.width,\n      height = _ref5.height,\n      degree = _ref5.degree;\n    degree = Math.abs(degree) % 180;\n    if (degree === 90) {\n      return {\n        width: height,\n        height: width\n      };\n    }\n    var arc = degree % 90 * Math.PI / 180;\n    var sinArc = Math.sin(arc);\n    var cosArc = Math.cos(arc);\n    var newWidth = width * cosArc + height * sinArc;\n    var newHeight = width * sinArc + height * cosArc;\n    return degree > 90 ? {\n      width: newHeight,\n      height: newWidth\n    } : {\n      width: newWidth,\n      height: newHeight\n    };\n  }\n\n  /**\n   * Get a canvas which drew the given image.\n   * @param {HTMLImageElement} image - The image for drawing.\n   * @param {Object} imageData - The image data.\n   * @param {Object} canvasData - The canvas data.\n   * @param {Object} options - The options.\n   * @returns {HTMLCanvasElement} The result canvas.\n   */\n  function getSourceCanvas(image, _ref6, _ref7, _ref8) {\n    var imageAspectRatio = _ref6.aspectRatio,\n      imageNaturalWidth = _ref6.naturalWidth,\n      imageNaturalHeight = _ref6.naturalHeight,\n      _ref6$rotate = _ref6.rotate,\n      rotate = _ref6$rotate === void 0 ? 0 : _ref6$rotate,\n      _ref6$scaleX = _ref6.scaleX,\n      scaleX = _ref6$scaleX === void 0 ? 1 : _ref6$scaleX,\n      _ref6$scaleY = _ref6.scaleY,\n      scaleY = _ref6$scaleY === void 0 ? 1 : _ref6$scaleY;\n    var aspectRatio = _ref7.aspectRatio,\n      naturalWidth = _ref7.naturalWidth,\n      naturalHeight = _ref7.naturalHeight;\n    var _ref8$fillColor = _ref8.fillColor,\n      fillColor = _ref8$fillColor === void 0 ? 'transparent' : _ref8$fillColor,\n      _ref8$imageSmoothingE = _ref8.imageSmoothingEnabled,\n      imageSmoothingEnabled = _ref8$imageSmoothingE === void 0 ? true : _ref8$imageSmoothingE,\n      _ref8$imageSmoothingQ = _ref8.imageSmoothingQuality,\n      imageSmoothingQuality = _ref8$imageSmoothingQ === void 0 ? 'low' : _ref8$imageSmoothingQ,\n      _ref8$maxWidth = _ref8.maxWidth,\n      maxWidth = _ref8$maxWidth === void 0 ? Infinity : _ref8$maxWidth,\n      _ref8$maxHeight = _ref8.maxHeight,\n      maxHeight = _ref8$maxHeight === void 0 ? Infinity : _ref8$maxHeight,\n      _ref8$minWidth = _ref8.minWidth,\n      minWidth = _ref8$minWidth === void 0 ? 0 : _ref8$minWidth,\n      _ref8$minHeight = _ref8.minHeight,\n      minHeight = _ref8$minHeight === void 0 ? 0 : _ref8$minHeight;\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    var maxSizes = getAdjustedSizes({\n      aspectRatio: aspectRatio,\n      width: maxWidth,\n      height: maxHeight\n    });\n    var minSizes = getAdjustedSizes({\n      aspectRatio: aspectRatio,\n      width: minWidth,\n      height: minHeight\n    }, 'cover');\n    var width = Math.min(maxSizes.width, Math.max(minSizes.width, naturalWidth));\n    var height = Math.min(maxSizes.height, Math.max(minSizes.height, naturalHeight));\n\n    // Note: should always use image's natural sizes for drawing as\n    // imageData.naturalWidth === canvasData.naturalHeight when rotate % 180 === 90\n    var destMaxSizes = getAdjustedSizes({\n      aspectRatio: imageAspectRatio,\n      width: maxWidth,\n      height: maxHeight\n    });\n    var destMinSizes = getAdjustedSizes({\n      aspectRatio: imageAspectRatio,\n      width: minWidth,\n      height: minHeight\n    }, 'cover');\n    var destWidth = Math.min(destMaxSizes.width, Math.max(destMinSizes.width, imageNaturalWidth));\n    var destHeight = Math.min(destMaxSizes.height, Math.max(destMinSizes.height, imageNaturalHeight));\n    var params = [-destWidth / 2, -destHeight / 2, destWidth, destHeight];\n    canvas.width = normalizeDecimalNumber(width);\n    canvas.height = normalizeDecimalNumber(height);\n    context.fillStyle = fillColor;\n    context.fillRect(0, 0, width, height);\n    context.save();\n    context.translate(width / 2, height / 2);\n    context.rotate(rotate * Math.PI / 180);\n    context.scale(scaleX, scaleY);\n    context.imageSmoothingEnabled = imageSmoothingEnabled;\n    context.imageSmoothingQuality = imageSmoothingQuality;\n    context.drawImage.apply(context, [image].concat(_toConsumableArray(params.map(function (param) {\n      return Math.floor(normalizeDecimalNumber(param));\n    }))));\n    context.restore();\n    return canvas;\n  }\n  var fromCharCode = String.fromCharCode;\n\n  /**\n   * Get string from char code in data view.\n   * @param {DataView} dataView - The data view for read.\n   * @param {number} start - The start index.\n   * @param {number} length - The read length.\n   * @returns {string} The read result.\n   */\n  function getStringFromCharCode(dataView, start, length) {\n    var str = '';\n    length += start;\n    for (var i = start; i < length; i += 1) {\n      str += fromCharCode(dataView.getUint8(i));\n    }\n    return str;\n  }\n  var REGEXP_DATA_URL_HEAD = /^data:.*,/;\n\n  /**\n   * Transform Data URL to array buffer.\n   * @param {string} dataURL - The Data URL to transform.\n   * @returns {ArrayBuffer} The result array buffer.\n   */\n  function dataURLToArrayBuffer(dataURL) {\n    var base64 = dataURL.replace(REGEXP_DATA_URL_HEAD, '');\n    var binary = atob(base64);\n    var arrayBuffer = new ArrayBuffer(binary.length);\n    var uint8 = new Uint8Array(arrayBuffer);\n    forEach(uint8, function (value, i) {\n      uint8[i] = binary.charCodeAt(i);\n    });\n    return arrayBuffer;\n  }\n\n  /**\n   * Transform array buffer to Data URL.\n   * @param {ArrayBuffer} arrayBuffer - The array buffer to transform.\n   * @param {string} mimeType - The mime type of the Data URL.\n   * @returns {string} The result Data URL.\n   */\n  function arrayBufferToDataURL(arrayBuffer, mimeType) {\n    var chunks = [];\n\n    // Chunk Typed Array for better performance (#435)\n    var chunkSize = 8192;\n    var uint8 = new Uint8Array(arrayBuffer);\n    while (uint8.length > 0) {\n      // XXX: Babel's `toConsumableArray` helper will throw error in IE or Safari 9\n      // eslint-disable-next-line prefer-spread\n      chunks.push(fromCharCode.apply(null, toArray(uint8.subarray(0, chunkSize))));\n      uint8 = uint8.subarray(chunkSize);\n    }\n    return \"data:\".concat(mimeType, \";base64,\").concat(btoa(chunks.join('')));\n  }\n\n  /**\n   * Get orientation value from given array buffer.\n   * @param {ArrayBuffer} arrayBuffer - The array buffer to read.\n   * @returns {number} The read orientation value.\n   */\n  function resetAndGetOrientation(arrayBuffer) {\n    var dataView = new DataView(arrayBuffer);\n    var orientation;\n\n    // Ignores range error when the image does not have correct Exif information\n    try {\n      var littleEndian;\n      var app1Start;\n      var ifdStart;\n\n      // Only handle JPEG image (start by 0xFFD8)\n      if (dataView.getUint8(0) === 0xFF && dataView.getUint8(1) === 0xD8) {\n        var length = dataView.byteLength;\n        var offset = 2;\n        while (offset + 1 < length) {\n          if (dataView.getUint8(offset) === 0xFF && dataView.getUint8(offset + 1) === 0xE1) {\n            app1Start = offset;\n            break;\n          }\n          offset += 1;\n        }\n      }\n      if (app1Start) {\n        var exifIDCode = app1Start + 4;\n        var tiffOffset = app1Start + 10;\n        if (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\n          var endianness = dataView.getUint16(tiffOffset);\n          littleEndian = endianness === 0x4949;\n          if (littleEndian || endianness === 0x4D4D /* bigEndian */) {\n            if (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002A) {\n              var firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\n              if (firstIFDOffset >= 0x00000008) {\n                ifdStart = tiffOffset + firstIFDOffset;\n              }\n            }\n          }\n        }\n      }\n      if (ifdStart) {\n        var _length = dataView.getUint16(ifdStart, littleEndian);\n        var _offset;\n        var i;\n        for (i = 0; i < _length; i += 1) {\n          _offset = ifdStart + i * 12 + 2;\n          if (dataView.getUint16(_offset, littleEndian) === 0x0112 /* Orientation */) {\n            // 8 is the offset of the current tag's value\n            _offset += 8;\n\n            // Get the original orientation value\n            orientation = dataView.getUint16(_offset, littleEndian);\n\n            // Override the orientation with its default value\n            dataView.setUint16(_offset, 1, littleEndian);\n            break;\n          }\n        }\n      }\n    } catch (error) {\n      orientation = 1;\n    }\n    return orientation;\n  }\n\n  /**\n   * Parse Exif Orientation value.\n   * @param {number} orientation - The orientation to parse.\n   * @returns {Object} The parsed result.\n   */\n  function parseOrientation(orientation) {\n    var rotate = 0;\n    var scaleX = 1;\n    var scaleY = 1;\n    switch (orientation) {\n      // Flip horizontal\n      case 2:\n        scaleX = -1;\n        break;\n\n      // Rotate left 180°\n      case 3:\n        rotate = -180;\n        break;\n\n      // Flip vertical\n      case 4:\n        scaleY = -1;\n        break;\n\n      // Flip vertical and rotate right 90°\n      case 5:\n        rotate = 90;\n        scaleY = -1;\n        break;\n\n      // Rotate right 90°\n      case 6:\n        rotate = 90;\n        break;\n\n      // Flip horizontal and rotate right 90°\n      case 7:\n        rotate = 90;\n        scaleX = -1;\n        break;\n\n      // Rotate left 90°\n      case 8:\n        rotate = -90;\n        break;\n    }\n    return {\n      rotate: rotate,\n      scaleX: scaleX,\n      scaleY: scaleY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initCanvas();\n      this.initCropBox();\n      this.renderCanvas();\n      if (this.cropped) {\n        this.renderCropBox();\n      }\n    },\n    initContainer: function initContainer() {\n      var element = this.element,\n        options = this.options,\n        container = this.container,\n        cropper = this.cropper;\n      var minWidth = Number(options.minContainerWidth);\n      var minHeight = Number(options.minContainerHeight);\n      addClass(cropper, CLASS_HIDDEN);\n      removeClass(element, CLASS_HIDDEN);\n      var containerData = {\n        width: Math.max(container.offsetWidth, minWidth >= 0 ? minWidth : MIN_CONTAINER_WIDTH),\n        height: Math.max(container.offsetHeight, minHeight >= 0 ? minHeight : MIN_CONTAINER_HEIGHT)\n      };\n      this.containerData = containerData;\n      setStyle(cropper, {\n        width: containerData.width,\n        height: containerData.height\n      });\n      addClass(element, CLASS_HIDDEN);\n      removeClass(cropper, CLASS_HIDDEN);\n    },\n    // Canvas (image wrapper)\n    initCanvas: function initCanvas() {\n      var containerData = this.containerData,\n        imageData = this.imageData;\n      var viewMode = this.options.viewMode;\n      var rotated = Math.abs(imageData.rotate) % 180 === 90;\n      var naturalWidth = rotated ? imageData.naturalHeight : imageData.naturalWidth;\n      var naturalHeight = rotated ? imageData.naturalWidth : imageData.naturalHeight;\n      var aspectRatio = naturalWidth / naturalHeight;\n      var canvasWidth = containerData.width;\n      var canvasHeight = containerData.height;\n      if (containerData.height * aspectRatio > containerData.width) {\n        if (viewMode === 3) {\n          canvasWidth = containerData.height * aspectRatio;\n        } else {\n          canvasHeight = containerData.width / aspectRatio;\n        }\n      } else if (viewMode === 3) {\n        canvasHeight = containerData.width / aspectRatio;\n      } else {\n        canvasWidth = containerData.height * aspectRatio;\n      }\n      var canvasData = {\n        aspectRatio: aspectRatio,\n        naturalWidth: naturalWidth,\n        naturalHeight: naturalHeight,\n        width: canvasWidth,\n        height: canvasHeight\n      };\n      this.canvasData = canvasData;\n      this.limited = viewMode === 1 || viewMode === 2;\n      this.limitCanvas(true, true);\n      canvasData.width = Math.min(Math.max(canvasData.width, canvasData.minWidth), canvasData.maxWidth);\n      canvasData.height = Math.min(Math.max(canvasData.height, canvasData.minHeight), canvasData.maxHeight);\n      canvasData.left = (containerData.width - canvasData.width) / 2;\n      canvasData.top = (containerData.height - canvasData.height) / 2;\n      canvasData.oldLeft = canvasData.left;\n      canvasData.oldTop = canvasData.top;\n      this.initialCanvasData = assign({}, canvasData);\n    },\n    limitCanvas: function limitCanvas(sizeLimited, positionLimited) {\n      var options = this.options,\n        containerData = this.containerData,\n        canvasData = this.canvasData,\n        cropBoxData = this.cropBoxData;\n      var viewMode = options.viewMode;\n      var aspectRatio = canvasData.aspectRatio;\n      var cropped = this.cropped && cropBoxData;\n      if (sizeLimited) {\n        var minCanvasWidth = Number(options.minCanvasWidth) || 0;\n        var minCanvasHeight = Number(options.minCanvasHeight) || 0;\n        if (viewMode > 1) {\n          minCanvasWidth = Math.max(minCanvasWidth, containerData.width);\n          minCanvasHeight = Math.max(minCanvasHeight, containerData.height);\n          if (viewMode === 3) {\n            if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n              minCanvasWidth = minCanvasHeight * aspectRatio;\n            } else {\n              minCanvasHeight = minCanvasWidth / aspectRatio;\n            }\n          }\n        } else if (viewMode > 0) {\n          if (minCanvasWidth) {\n            minCanvasWidth = Math.max(minCanvasWidth, cropped ? cropBoxData.width : 0);\n          } else if (minCanvasHeight) {\n            minCanvasHeight = Math.max(minCanvasHeight, cropped ? cropBoxData.height : 0);\n          } else if (cropped) {\n            minCanvasWidth = cropBoxData.width;\n            minCanvasHeight = cropBoxData.height;\n            if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n              minCanvasWidth = minCanvasHeight * aspectRatio;\n            } else {\n              minCanvasHeight = minCanvasWidth / aspectRatio;\n            }\n          }\n        }\n        var _getAdjustedSizes = getAdjustedSizes({\n          aspectRatio: aspectRatio,\n          width: minCanvasWidth,\n          height: minCanvasHeight\n        });\n        minCanvasWidth = _getAdjustedSizes.width;\n        minCanvasHeight = _getAdjustedSizes.height;\n        canvasData.minWidth = minCanvasWidth;\n        canvasData.minHeight = minCanvasHeight;\n        canvasData.maxWidth = Infinity;\n        canvasData.maxHeight = Infinity;\n      }\n      if (positionLimited) {\n        if (viewMode > (cropped ? 0 : 1)) {\n          var newCanvasLeft = containerData.width - canvasData.width;\n          var newCanvasTop = containerData.height - canvasData.height;\n          canvasData.minLeft = Math.min(0, newCanvasLeft);\n          canvasData.minTop = Math.min(0, newCanvasTop);\n          canvasData.maxLeft = Math.max(0, newCanvasLeft);\n          canvasData.maxTop = Math.max(0, newCanvasTop);\n          if (cropped && this.limited) {\n            canvasData.minLeft = Math.min(cropBoxData.left, cropBoxData.left + (cropBoxData.width - canvasData.width));\n            canvasData.minTop = Math.min(cropBoxData.top, cropBoxData.top + (cropBoxData.height - canvasData.height));\n            canvasData.maxLeft = cropBoxData.left;\n            canvasData.maxTop = cropBoxData.top;\n            if (viewMode === 2) {\n              if (canvasData.width >= containerData.width) {\n                canvasData.minLeft = Math.min(0, newCanvasLeft);\n                canvasData.maxLeft = Math.max(0, newCanvasLeft);\n              }\n              if (canvasData.height >= containerData.height) {\n                canvasData.minTop = Math.min(0, newCanvasTop);\n                canvasData.maxTop = Math.max(0, newCanvasTop);\n              }\n            }\n          }\n        } else {\n          canvasData.minLeft = -canvasData.width;\n          canvasData.minTop = -canvasData.height;\n          canvasData.maxLeft = containerData.width;\n          canvasData.maxTop = containerData.height;\n        }\n      }\n    },\n    renderCanvas: function renderCanvas(changed, transformed) {\n      var canvasData = this.canvasData,\n        imageData = this.imageData;\n      if (transformed) {\n        var _getRotatedSizes = getRotatedSizes({\n            width: imageData.naturalWidth * Math.abs(imageData.scaleX || 1),\n            height: imageData.naturalHeight * Math.abs(imageData.scaleY || 1),\n            degree: imageData.rotate || 0\n          }),\n          naturalWidth = _getRotatedSizes.width,\n          naturalHeight = _getRotatedSizes.height;\n        var width = canvasData.width * (naturalWidth / canvasData.naturalWidth);\n        var height = canvasData.height * (naturalHeight / canvasData.naturalHeight);\n        canvasData.left -= (width - canvasData.width) / 2;\n        canvasData.top -= (height - canvasData.height) / 2;\n        canvasData.width = width;\n        canvasData.height = height;\n        canvasData.aspectRatio = naturalWidth / naturalHeight;\n        canvasData.naturalWidth = naturalWidth;\n        canvasData.naturalHeight = naturalHeight;\n        this.limitCanvas(true, false);\n      }\n      if (canvasData.width > canvasData.maxWidth || canvasData.width < canvasData.minWidth) {\n        canvasData.left = canvasData.oldLeft;\n      }\n      if (canvasData.height > canvasData.maxHeight || canvasData.height < canvasData.minHeight) {\n        canvasData.top = canvasData.oldTop;\n      }\n      canvasData.width = Math.min(Math.max(canvasData.width, canvasData.minWidth), canvasData.maxWidth);\n      canvasData.height = Math.min(Math.max(canvasData.height, canvasData.minHeight), canvasData.maxHeight);\n      this.limitCanvas(false, true);\n      canvasData.left = Math.min(Math.max(canvasData.left, canvasData.minLeft), canvasData.maxLeft);\n      canvasData.top = Math.min(Math.max(canvasData.top, canvasData.minTop), canvasData.maxTop);\n      canvasData.oldLeft = canvasData.left;\n      canvasData.oldTop = canvasData.top;\n      setStyle(this.canvas, assign({\n        width: canvasData.width,\n        height: canvasData.height\n      }, getTransforms({\n        translateX: canvasData.left,\n        translateY: canvasData.top\n      })));\n      this.renderImage(changed);\n      if (this.cropped && this.limited) {\n        this.limitCropBox(true, true);\n      }\n    },\n    renderImage: function renderImage(changed) {\n      var canvasData = this.canvasData,\n        imageData = this.imageData;\n      var width = imageData.naturalWidth * (canvasData.width / canvasData.naturalWidth);\n      var height = imageData.naturalHeight * (canvasData.height / canvasData.naturalHeight);\n      assign(imageData, {\n        width: width,\n        height: height,\n        left: (canvasData.width - width) / 2,\n        top: (canvasData.height - height) / 2\n      });\n      setStyle(this.image, assign({\n        width: imageData.width,\n        height: imageData.height\n      }, getTransforms(assign({\n        translateX: imageData.left,\n        translateY: imageData.top\n      }, imageData))));\n      if (changed) {\n        this.output();\n      }\n    },\n    initCropBox: function initCropBox() {\n      var options = this.options,\n        canvasData = this.canvasData;\n      var aspectRatio = options.aspectRatio || options.initialAspectRatio;\n      var autoCropArea = Number(options.autoCropArea) || 0.8;\n      var cropBoxData = {\n        width: canvasData.width,\n        height: canvasData.height\n      };\n      if (aspectRatio) {\n        if (canvasData.height * aspectRatio > canvasData.width) {\n          cropBoxData.height = cropBoxData.width / aspectRatio;\n        } else {\n          cropBoxData.width = cropBoxData.height * aspectRatio;\n        }\n      }\n      this.cropBoxData = cropBoxData;\n      this.limitCropBox(true, true);\n\n      // Initialize auto crop area\n      cropBoxData.width = Math.min(Math.max(cropBoxData.width, cropBoxData.minWidth), cropBoxData.maxWidth);\n      cropBoxData.height = Math.min(Math.max(cropBoxData.height, cropBoxData.minHeight), cropBoxData.maxHeight);\n\n      // The width/height of auto crop area must large than \"minWidth/Height\"\n      cropBoxData.width = Math.max(cropBoxData.minWidth, cropBoxData.width * autoCropArea);\n      cropBoxData.height = Math.max(cropBoxData.minHeight, cropBoxData.height * autoCropArea);\n      cropBoxData.left = canvasData.left + (canvasData.width - cropBoxData.width) / 2;\n      cropBoxData.top = canvasData.top + (canvasData.height - cropBoxData.height) / 2;\n      cropBoxData.oldLeft = cropBoxData.left;\n      cropBoxData.oldTop = cropBoxData.top;\n      this.initialCropBoxData = assign({}, cropBoxData);\n    },\n    limitCropBox: function limitCropBox(sizeLimited, positionLimited) {\n      var options = this.options,\n        containerData = this.containerData,\n        canvasData = this.canvasData,\n        cropBoxData = this.cropBoxData,\n        limited = this.limited;\n      var aspectRatio = options.aspectRatio;\n      if (sizeLimited) {\n        var minCropBoxWidth = Number(options.minCropBoxWidth) || 0;\n        var minCropBoxHeight = Number(options.minCropBoxHeight) || 0;\n        var maxCropBoxWidth = limited ? Math.min(containerData.width, canvasData.width, canvasData.width + canvasData.left, containerData.width - canvasData.left) : containerData.width;\n        var maxCropBoxHeight = limited ? Math.min(containerData.height, canvasData.height, canvasData.height + canvasData.top, containerData.height - canvasData.top) : containerData.height;\n\n        // The min/maxCropBoxWidth/Height must be less than container's width/height\n        minCropBoxWidth = Math.min(minCropBoxWidth, containerData.width);\n        minCropBoxHeight = Math.min(minCropBoxHeight, containerData.height);\n        if (aspectRatio) {\n          if (minCropBoxWidth && minCropBoxHeight) {\n            if (minCropBoxHeight * aspectRatio > minCropBoxWidth) {\n              minCropBoxHeight = minCropBoxWidth / aspectRatio;\n            } else {\n              minCropBoxWidth = minCropBoxHeight * aspectRatio;\n            }\n          } else if (minCropBoxWidth) {\n            minCropBoxHeight = minCropBoxWidth / aspectRatio;\n          } else if (minCropBoxHeight) {\n            minCropBoxWidth = minCropBoxHeight * aspectRatio;\n          }\n          if (maxCropBoxHeight * aspectRatio > maxCropBoxWidth) {\n            maxCropBoxHeight = maxCropBoxWidth / aspectRatio;\n          } else {\n            maxCropBoxWidth = maxCropBoxHeight * aspectRatio;\n          }\n        }\n\n        // The minWidth/Height must be less than maxWidth/Height\n        cropBoxData.minWidth = Math.min(minCropBoxWidth, maxCropBoxWidth);\n        cropBoxData.minHeight = Math.min(minCropBoxHeight, maxCropBoxHeight);\n        cropBoxData.maxWidth = maxCropBoxWidth;\n        cropBoxData.maxHeight = maxCropBoxHeight;\n      }\n      if (positionLimited) {\n        if (limited) {\n          cropBoxData.minLeft = Math.max(0, canvasData.left);\n          cropBoxData.minTop = Math.max(0, canvasData.top);\n          cropBoxData.maxLeft = Math.min(containerData.width, canvasData.left + canvasData.width) - cropBoxData.width;\n          cropBoxData.maxTop = Math.min(containerData.height, canvasData.top + canvasData.height) - cropBoxData.height;\n        } else {\n          cropBoxData.minLeft = 0;\n          cropBoxData.minTop = 0;\n          cropBoxData.maxLeft = containerData.width - cropBoxData.width;\n          cropBoxData.maxTop = containerData.height - cropBoxData.height;\n        }\n      }\n    },\n    renderCropBox: function renderCropBox() {\n      var options = this.options,\n        containerData = this.containerData,\n        cropBoxData = this.cropBoxData;\n      if (cropBoxData.width > cropBoxData.maxWidth || cropBoxData.width < cropBoxData.minWidth) {\n        cropBoxData.left = cropBoxData.oldLeft;\n      }\n      if (cropBoxData.height > cropBoxData.maxHeight || cropBoxData.height < cropBoxData.minHeight) {\n        cropBoxData.top = cropBoxData.oldTop;\n      }\n      cropBoxData.width = Math.min(Math.max(cropBoxData.width, cropBoxData.minWidth), cropBoxData.maxWidth);\n      cropBoxData.height = Math.min(Math.max(cropBoxData.height, cropBoxData.minHeight), cropBoxData.maxHeight);\n      this.limitCropBox(false, true);\n      cropBoxData.left = Math.min(Math.max(cropBoxData.left, cropBoxData.minLeft), cropBoxData.maxLeft);\n      cropBoxData.top = Math.min(Math.max(cropBoxData.top, cropBoxData.minTop), cropBoxData.maxTop);\n      cropBoxData.oldLeft = cropBoxData.left;\n      cropBoxData.oldTop = cropBoxData.top;\n      if (options.movable && options.cropBoxMovable) {\n        // Turn to move the canvas when the crop box is equal to the container\n        setData(this.face, DATA_ACTION, cropBoxData.width >= containerData.width && cropBoxData.height >= containerData.height ? ACTION_MOVE : ACTION_ALL);\n      }\n      setStyle(this.cropBox, assign({\n        width: cropBoxData.width,\n        height: cropBoxData.height\n      }, getTransforms({\n        translateX: cropBoxData.left,\n        translateY: cropBoxData.top\n      })));\n      if (this.cropped && this.limited) {\n        this.limitCanvas(true, true);\n      }\n      if (!this.disabled) {\n        this.output();\n      }\n    },\n    output: function output() {\n      this.preview();\n      dispatchEvent(this.element, EVENT_CROP, this.getData());\n    }\n  };\n\n  var preview = {\n    initPreview: function initPreview() {\n      var element = this.element,\n        crossOrigin = this.crossOrigin;\n      var preview = this.options.preview;\n      var url = crossOrigin ? this.crossOriginUrl : this.url;\n      var alt = element.alt || 'The image to preview';\n      var image = document.createElement('img');\n      if (crossOrigin) {\n        image.crossOrigin = crossOrigin;\n      }\n      image.src = url;\n      image.alt = alt;\n      this.viewBox.appendChild(image);\n      this.viewBoxImage = image;\n      if (!preview) {\n        return;\n      }\n      var previews = preview;\n      if (typeof preview === 'string') {\n        previews = element.ownerDocument.querySelectorAll(preview);\n      } else if (preview.querySelector) {\n        previews = [preview];\n      }\n      this.previews = previews;\n      forEach(previews, function (el) {\n        var img = document.createElement('img');\n\n        // Save the original size for recover\n        setData(el, DATA_PREVIEW, {\n          width: el.offsetWidth,\n          height: el.offsetHeight,\n          html: el.innerHTML\n        });\n        if (crossOrigin) {\n          img.crossOrigin = crossOrigin;\n        }\n        img.src = url;\n        img.alt = alt;\n\n        /**\n         * Override img element styles\n         * Add `display:block` to avoid margin top issue\n         * Add `height:auto` to override `height` attribute on IE8\n         * (Occur only when margin-top <= -height)\n         */\n        img.style.cssText = 'display:block;' + 'width:100%;' + 'height:auto;' + 'min-width:0!important;' + 'min-height:0!important;' + 'max-width:none!important;' + 'max-height:none!important;' + 'image-orientation:0deg!important;\"';\n        el.innerHTML = '';\n        el.appendChild(img);\n      });\n    },\n    resetPreview: function resetPreview() {\n      forEach(this.previews, function (element) {\n        var data = getData(element, DATA_PREVIEW);\n        setStyle(element, {\n          width: data.width,\n          height: data.height\n        });\n        element.innerHTML = data.html;\n        removeData(element, DATA_PREVIEW);\n      });\n    },\n    preview: function preview() {\n      var imageData = this.imageData,\n        canvasData = this.canvasData,\n        cropBoxData = this.cropBoxData;\n      var cropBoxWidth = cropBoxData.width,\n        cropBoxHeight = cropBoxData.height;\n      var width = imageData.width,\n        height = imageData.height;\n      var left = cropBoxData.left - canvasData.left - imageData.left;\n      var top = cropBoxData.top - canvasData.top - imageData.top;\n      if (!this.cropped || this.disabled) {\n        return;\n      }\n      setStyle(this.viewBoxImage, assign({\n        width: width,\n        height: height\n      }, getTransforms(assign({\n        translateX: -left,\n        translateY: -top\n      }, imageData))));\n      forEach(this.previews, function (element) {\n        var data = getData(element, DATA_PREVIEW);\n        var originalWidth = data.width;\n        var originalHeight = data.height;\n        var newWidth = originalWidth;\n        var newHeight = originalHeight;\n        var ratio = 1;\n        if (cropBoxWidth) {\n          ratio = originalWidth / cropBoxWidth;\n          newHeight = cropBoxHeight * ratio;\n        }\n        if (cropBoxHeight && newHeight > originalHeight) {\n          ratio = originalHeight / cropBoxHeight;\n          newWidth = cropBoxWidth * ratio;\n          newHeight = originalHeight;\n        }\n        setStyle(element, {\n          width: newWidth,\n          height: newHeight\n        });\n        setStyle(element.getElementsByTagName('img')[0], assign({\n          width: width * ratio,\n          height: height * ratio\n        }, getTransforms(assign({\n          translateX: -left * ratio,\n          translateY: -top * ratio\n        }, imageData))));\n      });\n    }\n  };\n\n  var events = {\n    bind: function bind() {\n      var element = this.element,\n        options = this.options,\n        cropper = this.cropper;\n      if (isFunction(options.cropstart)) {\n        addListener(element, EVENT_CROP_START, options.cropstart);\n      }\n      if (isFunction(options.cropmove)) {\n        addListener(element, EVENT_CROP_MOVE, options.cropmove);\n      }\n      if (isFunction(options.cropend)) {\n        addListener(element, EVENT_CROP_END, options.cropend);\n      }\n      if (isFunction(options.crop)) {\n        addListener(element, EVENT_CROP, options.crop);\n      }\n      if (isFunction(options.zoom)) {\n        addListener(element, EVENT_ZOOM, options.zoom);\n      }\n      addListener(cropper, EVENT_POINTER_DOWN, this.onCropStart = this.cropStart.bind(this));\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(cropper, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n      if (options.toggleDragModeOnDblclick) {\n        addListener(cropper, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n      addListener(element.ownerDocument, EVENT_POINTER_MOVE, this.onCropMove = this.cropMove.bind(this));\n      addListener(element.ownerDocument, EVENT_POINTER_UP, this.onCropEnd = this.cropEnd.bind(this));\n      if (options.responsive) {\n        addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var element = this.element,\n        options = this.options,\n        cropper = this.cropper;\n      if (isFunction(options.cropstart)) {\n        removeListener(element, EVENT_CROP_START, options.cropstart);\n      }\n      if (isFunction(options.cropmove)) {\n        removeListener(element, EVENT_CROP_MOVE, options.cropmove);\n      }\n      if (isFunction(options.cropend)) {\n        removeListener(element, EVENT_CROP_END, options.cropend);\n      }\n      if (isFunction(options.crop)) {\n        removeListener(element, EVENT_CROP, options.crop);\n      }\n      if (isFunction(options.zoom)) {\n        removeListener(element, EVENT_ZOOM, options.zoom);\n      }\n      removeListener(cropper, EVENT_POINTER_DOWN, this.onCropStart);\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(cropper, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n      if (options.toggleDragModeOnDblclick) {\n        removeListener(cropper, EVENT_DBLCLICK, this.onDblclick);\n      }\n      removeListener(element.ownerDocument, EVENT_POINTER_MOVE, this.onCropMove);\n      removeListener(element.ownerDocument, EVENT_POINTER_UP, this.onCropEnd);\n      if (options.responsive) {\n        removeListener(window, EVENT_RESIZE, this.onResize);\n      }\n    }\n  };\n\n  var handlers = {\n    resize: function resize() {\n      if (this.disabled) {\n        return;\n      }\n      var options = this.options,\n        container = this.container,\n        containerData = this.containerData;\n      var ratioX = container.offsetWidth / containerData.width;\n      var ratioY = container.offsetHeight / containerData.height;\n      var ratio = Math.abs(ratioX - 1) > Math.abs(ratioY - 1) ? ratioX : ratioY;\n\n      // Resize when width changed or height changed\n      if (ratio !== 1) {\n        var canvasData;\n        var cropBoxData;\n        if (options.restore) {\n          canvasData = this.getCanvasData();\n          cropBoxData = this.getCropBoxData();\n        }\n        this.render();\n        if (options.restore) {\n          this.setCanvasData(forEach(canvasData, function (n, i) {\n            canvasData[i] = n * ratio;\n          }));\n          this.setCropBoxData(forEach(cropBoxData, function (n, i) {\n            cropBoxData[i] = n * ratio;\n          }));\n        }\n      }\n    },\n    dblclick: function dblclick() {\n      if (this.disabled || this.options.dragMode === DRAG_MODE_NONE) {\n        return;\n      }\n      this.setDragMode(hasClass(this.dragBox, CLASS_CROP) ? DRAG_MODE_MOVE : DRAG_MODE_CROP);\n    },\n    wheel: function wheel(event) {\n      var _this = this;\n      var ratio = Number(this.options.wheelZoomRatio) || 0.1;\n      var delta = 1;\n      if (this.disabled) {\n        return;\n      }\n      event.preventDefault();\n\n      // Limit wheel speed to prevent zoom too fast (#21)\n      if (this.wheeling) {\n        return;\n      }\n      this.wheeling = true;\n      setTimeout(function () {\n        _this.wheeling = false;\n      }, 50);\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n      this.zoom(-delta * ratio, event);\n    },\n    cropStart: function cropStart(event) {\n      var buttons = event.buttons,\n        button = event.button;\n      if (this.disabled\n\n      // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && (\n      // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0\n\n      // Open context menu\n      || event.ctrlKey)) {\n        return;\n      }\n      var options = this.options,\n        pointers = this.pointers;\n      var action;\n      if (event.changedTouches) {\n        // Handle touch event\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        // Handle mouse event and pointer event\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n      if (Object.keys(pointers).length > 1 && options.zoomable && options.zoomOnTouch) {\n        action = ACTION_ZOOM;\n      } else {\n        action = getData(event.target, DATA_ACTION);\n      }\n      if (!REGEXP_ACTIONS.test(action)) {\n        return;\n      }\n      if (dispatchEvent(this.element, EVENT_CROP_START, {\n        originalEvent: event,\n        action: action\n      }) === false) {\n        return;\n      }\n\n      // This line is required for preventing page zooming in iOS browsers\n      event.preventDefault();\n      this.action = action;\n      this.cropping = false;\n      if (action === ACTION_CROP) {\n        this.cropping = true;\n        addClass(this.dragBox, CLASS_MODAL);\n      }\n    },\n    cropMove: function cropMove(event) {\n      var action = this.action;\n      if (this.disabled || !action) {\n        return;\n      }\n      var pointers = this.pointers;\n      event.preventDefault();\n      if (dispatchEvent(this.element, EVENT_CROP_MOVE, {\n        originalEvent: event,\n        action: action\n      }) === false) {\n        return;\n      }\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          // The first parameter should not be undefined (#432)\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n      this.change(event);\n    },\n    cropEnd: function cropEnd(event) {\n      if (this.disabled) {\n        return;\n      }\n      var action = this.action,\n        pointers = this.pointers;\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          delete pointers[touch.identifier];\n        });\n      } else {\n        delete pointers[event.pointerId || 0];\n      }\n      if (!action) {\n        return;\n      }\n      event.preventDefault();\n      if (!Object.keys(pointers).length) {\n        this.action = '';\n      }\n      if (this.cropping) {\n        this.cropping = false;\n        toggleClass(this.dragBox, CLASS_MODAL, this.cropped && this.options.modal);\n      }\n      dispatchEvent(this.element, EVENT_CROP_END, {\n        originalEvent: event,\n        action: action\n      });\n    }\n  };\n\n  var change = {\n    change: function change(event) {\n      var options = this.options,\n        canvasData = this.canvasData,\n        containerData = this.containerData,\n        cropBoxData = this.cropBoxData,\n        pointers = this.pointers;\n      var action = this.action;\n      var aspectRatio = options.aspectRatio;\n      var left = cropBoxData.left,\n        top = cropBoxData.top,\n        width = cropBoxData.width,\n        height = cropBoxData.height;\n      var right = left + width;\n      var bottom = top + height;\n      var minLeft = 0;\n      var minTop = 0;\n      var maxWidth = containerData.width;\n      var maxHeight = containerData.height;\n      var renderable = true;\n      var offset;\n\n      // Locking aspect ratio in \"free mode\" by holding shift key\n      if (!aspectRatio && event.shiftKey) {\n        aspectRatio = width && height ? width / height : 1;\n      }\n      if (this.limited) {\n        minLeft = cropBoxData.minLeft;\n        minTop = cropBoxData.minTop;\n        maxWidth = minLeft + Math.min(containerData.width, canvasData.width, canvasData.left + canvasData.width);\n        maxHeight = minTop + Math.min(containerData.height, canvasData.height, canvasData.top + canvasData.height);\n      }\n      var pointer = pointers[Object.keys(pointers)[0]];\n      var range = {\n        x: pointer.endX - pointer.startX,\n        y: pointer.endY - pointer.startY\n      };\n      var check = function check(side) {\n        switch (side) {\n          case ACTION_EAST:\n            if (right + range.x > maxWidth) {\n              range.x = maxWidth - right;\n            }\n            break;\n          case ACTION_WEST:\n            if (left + range.x < minLeft) {\n              range.x = minLeft - left;\n            }\n            break;\n          case ACTION_NORTH:\n            if (top + range.y < minTop) {\n              range.y = minTop - top;\n            }\n            break;\n          case ACTION_SOUTH:\n            if (bottom + range.y > maxHeight) {\n              range.y = maxHeight - bottom;\n            }\n            break;\n        }\n      };\n      switch (action) {\n        // Move crop box\n        case ACTION_ALL:\n          left += range.x;\n          top += range.y;\n          break;\n\n        // Resize crop box\n        case ACTION_EAST:\n          if (range.x >= 0 && (right >= maxWidth || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n            renderable = false;\n            break;\n          }\n          check(ACTION_EAST);\n          width += range.x;\n          if (width < 0) {\n            action = ACTION_WEST;\n            width = -width;\n            left -= width;\n          }\n          if (aspectRatio) {\n            height = width / aspectRatio;\n            top += (cropBoxData.height - height) / 2;\n          }\n          break;\n        case ACTION_NORTH:\n          if (range.y <= 0 && (top <= minTop || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n            renderable = false;\n            break;\n          }\n          check(ACTION_NORTH);\n          height -= range.y;\n          top += range.y;\n          if (height < 0) {\n            action = ACTION_SOUTH;\n            height = -height;\n            top -= height;\n          }\n          if (aspectRatio) {\n            width = height * aspectRatio;\n            left += (cropBoxData.width - width) / 2;\n          }\n          break;\n        case ACTION_WEST:\n          if (range.x <= 0 && (left <= minLeft || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n            renderable = false;\n            break;\n          }\n          check(ACTION_WEST);\n          width -= range.x;\n          left += range.x;\n          if (width < 0) {\n            action = ACTION_EAST;\n            width = -width;\n            left -= width;\n          }\n          if (aspectRatio) {\n            height = width / aspectRatio;\n            top += (cropBoxData.height - height) / 2;\n          }\n          break;\n        case ACTION_SOUTH:\n          if (range.y >= 0 && (bottom >= maxHeight || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n            renderable = false;\n            break;\n          }\n          check(ACTION_SOUTH);\n          height += range.y;\n          if (height < 0) {\n            action = ACTION_NORTH;\n            height = -height;\n            top -= height;\n          }\n          if (aspectRatio) {\n            width = height * aspectRatio;\n            left += (cropBoxData.width - width) / 2;\n          }\n          break;\n        case ACTION_NORTH_EAST:\n          if (aspectRatio) {\n            if (range.y <= 0 && (top <= minTop || right >= maxWidth)) {\n              renderable = false;\n              break;\n            }\n            check(ACTION_NORTH);\n            height -= range.y;\n            top += range.y;\n            width = height * aspectRatio;\n          } else {\n            check(ACTION_NORTH);\n            check(ACTION_EAST);\n            if (range.x >= 0) {\n              if (right < maxWidth) {\n                width += range.x;\n              } else if (range.y <= 0 && top <= minTop) {\n                renderable = false;\n              }\n            } else {\n              width += range.x;\n            }\n            if (range.y <= 0) {\n              if (top > minTop) {\n                height -= range.y;\n                top += range.y;\n              }\n            } else {\n              height -= range.y;\n              top += range.y;\n            }\n          }\n          if (width < 0 && height < 0) {\n            action = ACTION_SOUTH_WEST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_NORTH_WEST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_SOUTH_EAST;\n            height = -height;\n            top -= height;\n          }\n          break;\n        case ACTION_NORTH_WEST:\n          if (aspectRatio) {\n            if (range.y <= 0 && (top <= minTop || left <= minLeft)) {\n              renderable = false;\n              break;\n            }\n            check(ACTION_NORTH);\n            height -= range.y;\n            top += range.y;\n            width = height * aspectRatio;\n            left += cropBoxData.width - width;\n          } else {\n            check(ACTION_NORTH);\n            check(ACTION_WEST);\n            if (range.x <= 0) {\n              if (left > minLeft) {\n                width -= range.x;\n                left += range.x;\n              } else if (range.y <= 0 && top <= minTop) {\n                renderable = false;\n              }\n            } else {\n              width -= range.x;\n              left += range.x;\n            }\n            if (range.y <= 0) {\n              if (top > minTop) {\n                height -= range.y;\n                top += range.y;\n              }\n            } else {\n              height -= range.y;\n              top += range.y;\n            }\n          }\n          if (width < 0 && height < 0) {\n            action = ACTION_SOUTH_EAST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_NORTH_EAST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_SOUTH_WEST;\n            height = -height;\n            top -= height;\n          }\n          break;\n        case ACTION_SOUTH_WEST:\n          if (aspectRatio) {\n            if (range.x <= 0 && (left <= minLeft || bottom >= maxHeight)) {\n              renderable = false;\n              break;\n            }\n            check(ACTION_WEST);\n            width -= range.x;\n            left += range.x;\n            height = width / aspectRatio;\n          } else {\n            check(ACTION_SOUTH);\n            check(ACTION_WEST);\n            if (range.x <= 0) {\n              if (left > minLeft) {\n                width -= range.x;\n                left += range.x;\n              } else if (range.y >= 0 && bottom >= maxHeight) {\n                renderable = false;\n              }\n            } else {\n              width -= range.x;\n              left += range.x;\n            }\n            if (range.y >= 0) {\n              if (bottom < maxHeight) {\n                height += range.y;\n              }\n            } else {\n              height += range.y;\n            }\n          }\n          if (width < 0 && height < 0) {\n            action = ACTION_NORTH_EAST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_SOUTH_EAST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_NORTH_WEST;\n            height = -height;\n            top -= height;\n          }\n          break;\n        case ACTION_SOUTH_EAST:\n          if (aspectRatio) {\n            if (range.x >= 0 && (right >= maxWidth || bottom >= maxHeight)) {\n              renderable = false;\n              break;\n            }\n            check(ACTION_EAST);\n            width += range.x;\n            height = width / aspectRatio;\n          } else {\n            check(ACTION_SOUTH);\n            check(ACTION_EAST);\n            if (range.x >= 0) {\n              if (right < maxWidth) {\n                width += range.x;\n              } else if (range.y >= 0 && bottom >= maxHeight) {\n                renderable = false;\n              }\n            } else {\n              width += range.x;\n            }\n            if (range.y >= 0) {\n              if (bottom < maxHeight) {\n                height += range.y;\n              }\n            } else {\n              height += range.y;\n            }\n          }\n          if (width < 0 && height < 0) {\n            action = ACTION_NORTH_WEST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_SOUTH_WEST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_NORTH_EAST;\n            height = -height;\n            top -= height;\n          }\n          break;\n\n        // Move canvas\n        case ACTION_MOVE:\n          this.move(range.x, range.y);\n          renderable = false;\n          break;\n\n        // Zoom canvas\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), event);\n          renderable = false;\n          break;\n\n        // Create crop box\n        case ACTION_CROP:\n          if (!range.x || !range.y) {\n            renderable = false;\n            break;\n          }\n          offset = getOffset(this.cropper);\n          left = pointer.startX - offset.left;\n          top = pointer.startY - offset.top;\n          width = cropBoxData.minWidth;\n          height = cropBoxData.minHeight;\n          if (range.x > 0) {\n            action = range.y > 0 ? ACTION_SOUTH_EAST : ACTION_NORTH_EAST;\n          } else if (range.x < 0) {\n            left -= width;\n            action = range.y > 0 ? ACTION_SOUTH_WEST : ACTION_NORTH_WEST;\n          }\n          if (range.y < 0) {\n            top -= height;\n          }\n\n          // Show the crop box if is hidden\n          if (!this.cropped) {\n            removeClass(this.cropBox, CLASS_HIDDEN);\n            this.cropped = true;\n            if (this.limited) {\n              this.limitCropBox(true, true);\n            }\n          }\n          break;\n      }\n      if (renderable) {\n        cropBoxData.width = width;\n        cropBoxData.height = height;\n        cropBoxData.left = left;\n        cropBoxData.top = top;\n        this.action = action;\n        this.renderCropBox();\n      }\n\n      // Override\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    }\n  };\n\n  var methods = {\n    // Show the crop box manually\n    crop: function crop() {\n      if (this.ready && !this.cropped && !this.disabled) {\n        this.cropped = true;\n        this.limitCropBox(true, true);\n        if (this.options.modal) {\n          addClass(this.dragBox, CLASS_MODAL);\n        }\n        removeClass(this.cropBox, CLASS_HIDDEN);\n        this.setCropBoxData(this.initialCropBoxData);\n      }\n      return this;\n    },\n    // Reset the image and crop box to their initial states\n    reset: function reset() {\n      if (this.ready && !this.disabled) {\n        this.imageData = assign({}, this.initialImageData);\n        this.canvasData = assign({}, this.initialCanvasData);\n        this.cropBoxData = assign({}, this.initialCropBoxData);\n        this.renderCanvas();\n        if (this.cropped) {\n          this.renderCropBox();\n        }\n      }\n      return this;\n    },\n    // Clear the crop box\n    clear: function clear() {\n      if (this.cropped && !this.disabled) {\n        assign(this.cropBoxData, {\n          left: 0,\n          top: 0,\n          width: 0,\n          height: 0\n        });\n        this.cropped = false;\n        this.renderCropBox();\n        this.limitCanvas(true, true);\n\n        // Render canvas after crop box rendered\n        this.renderCanvas();\n        removeClass(this.dragBox, CLASS_MODAL);\n        addClass(this.cropBox, CLASS_HIDDEN);\n      }\n      return this;\n    },\n    /**\n     * Replace the image's src and rebuild the cropper\n     * @param {string} url - The new URL.\n     * @param {boolean} [hasSameSize] - Indicate if the new image has the same size as the old one.\n     * @returns {Cropper} this\n     */\n    replace: function replace(url) {\n      var hasSameSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      if (!this.disabled && url) {\n        if (this.isImg) {\n          this.element.src = url;\n        }\n        if (hasSameSize) {\n          this.url = url;\n          this.image.src = url;\n          if (this.ready) {\n            this.viewBoxImage.src = url;\n            forEach(this.previews, function (element) {\n              element.getElementsByTagName('img')[0].src = url;\n            });\n          }\n        } else {\n          if (this.isImg) {\n            this.replaced = true;\n          }\n          this.options.data = null;\n          this.uncreate();\n          this.load(url);\n        }\n      }\n      return this;\n    },\n    // Enable (unfreeze) the cropper\n    enable: function enable() {\n      if (this.ready && this.disabled) {\n        this.disabled = false;\n        removeClass(this.cropper, CLASS_DISABLED);\n      }\n      return this;\n    },\n    // Disable (freeze) the cropper\n    disable: function disable() {\n      if (this.ready && !this.disabled) {\n        this.disabled = true;\n        addClass(this.cropper, CLASS_DISABLED);\n      }\n      return this;\n    },\n    /**\n     * Destroy the cropper and remove the instance from the image\n     * @returns {Cropper} this\n     */\n    destroy: function destroy() {\n      var element = this.element;\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n      element[NAMESPACE] = undefined;\n      if (this.isImg && this.replaced) {\n        element.src = this.originalUrl;\n      }\n      this.uncreate();\n      return this;\n    },\n    /**\n     * Move the canvas with relative offsets\n     * @param {number} offsetX - The relative offset distance on the x-axis.\n     * @param {number} [offsetY=offsetX] - The relative offset distance on the y-axis.\n     * @returns {Cropper} this\n     */\n    move: function move(offsetX) {\n      var offsetY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : offsetX;\n      var _this$canvasData = this.canvasData,\n        left = _this$canvasData.left,\n        top = _this$canvasData.top;\n      return this.moveTo(isUndefined(offsetX) ? offsetX : left + Number(offsetX), isUndefined(offsetY) ? offsetY : top + Number(offsetY));\n    },\n    /**\n     * Move the canvas to an absolute point\n     * @param {number} x - The x-axis coordinate.\n     * @param {number} [y=x] - The y-axis coordinate.\n     * @returns {Cropper} this\n     */\n    moveTo: function moveTo(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var canvasData = this.canvasData;\n      var changed = false;\n      x = Number(x);\n      y = Number(y);\n      if (this.ready && !this.disabled && this.options.movable) {\n        if (isNumber(x)) {\n          canvasData.left = x;\n          changed = true;\n        }\n        if (isNumber(y)) {\n          canvasData.top = y;\n          changed = true;\n        }\n        if (changed) {\n          this.renderCanvas(true);\n        }\n      }\n      return this;\n    },\n    /**\n     * Zoom the canvas with a relative ratio\n     * @param {number} ratio - The target ratio.\n     * @param {Event} _originalEvent - The original event if any.\n     * @returns {Cropper} this\n     */\n    zoom: function zoom(ratio, _originalEvent) {\n      var canvasData = this.canvasData;\n      ratio = Number(ratio);\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n      return this.zoomTo(canvasData.width * ratio / canvasData.naturalWidth, null, _originalEvent);\n    },\n    /**\n     * Zoom the canvas to an absolute ratio\n     * @param {number} ratio - The target ratio.\n     * @param {Object} pivot - The zoom pivot point coordinate.\n     * @param {Event} _originalEvent - The original event if any.\n     * @returns {Cropper} this\n     */\n    zoomTo: function zoomTo(ratio, pivot, _originalEvent) {\n      var options = this.options,\n        canvasData = this.canvasData;\n      var width = canvasData.width,\n        height = canvasData.height,\n        naturalWidth = canvasData.naturalWidth,\n        naturalHeight = canvasData.naturalHeight;\n      ratio = Number(ratio);\n      if (ratio >= 0 && this.ready && !this.disabled && options.zoomable) {\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        if (dispatchEvent(this.element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: width / naturalWidth,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n        if (_originalEvent) {\n          var pointers = this.pointers;\n          var offset = getOffset(this.cropper);\n          var center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          };\n\n          // Zoom from the triggering point of the event\n          canvasData.left -= (newWidth - width) * ((center.pageX - offset.left - canvasData.left) / width);\n          canvasData.top -= (newHeight - height) * ((center.pageY - offset.top - canvasData.top) / height);\n        } else if (isPlainObject(pivot) && isNumber(pivot.x) && isNumber(pivot.y)) {\n          canvasData.left -= (newWidth - width) * ((pivot.x - canvasData.left) / width);\n          canvasData.top -= (newHeight - height) * ((pivot.y - canvasData.top) / height);\n        } else {\n          // Zoom from the center of the canvas\n          canvasData.left -= (newWidth - width) / 2;\n          canvasData.top -= (newHeight - height) / 2;\n        }\n        canvasData.width = newWidth;\n        canvasData.height = newHeight;\n        this.renderCanvas(true);\n      }\n      return this;\n    },\n    /**\n     * Rotate the canvas with a relative degree\n     * @param {number} degree - The rotate degree.\n     * @returns {Cropper} this\n     */\n    rotate: function rotate(degree) {\n      return this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n    },\n    /**\n     * Rotate the canvas to an absolute degree\n     * @param {number} degree - The rotate degree.\n     * @returns {Cropper} this\n     */\n    rotateTo: function rotateTo(degree) {\n      degree = Number(degree);\n      if (isNumber(degree) && this.ready && !this.disabled && this.options.rotatable) {\n        this.imageData.rotate = degree % 360;\n        this.renderCanvas(true, true);\n      }\n      return this;\n    },\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Cropper} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      var scaleY = this.imageData.scaleY;\n      return this.scale(_scaleX, isNumber(scaleY) ? scaleY : 1);\n    },\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Cropper} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      var scaleX = this.imageData.scaleX;\n      return this.scale(isNumber(scaleX) ? scaleX : 1, _scaleY);\n    },\n    /**\n     * Scale the image\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Cropper} this\n     */\n    scale: function scale(scaleX) {\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var imageData = this.imageData;\n      var transformed = false;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n      if (this.ready && !this.disabled && this.options.scalable) {\n        if (isNumber(scaleX)) {\n          imageData.scaleX = scaleX;\n          transformed = true;\n        }\n        if (isNumber(scaleY)) {\n          imageData.scaleY = scaleY;\n          transformed = true;\n        }\n        if (transformed) {\n          this.renderCanvas(true, true);\n        }\n      }\n      return this;\n    },\n    /**\n     * Get the cropped area position and size data (base on the original image)\n     * @param {boolean} [rounded=false] - Indicate if round the data values or not.\n     * @returns {Object} The result cropped data.\n     */\n    getData: function getData() {\n      var rounded = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var options = this.options,\n        imageData = this.imageData,\n        canvasData = this.canvasData,\n        cropBoxData = this.cropBoxData;\n      var data;\n      if (this.ready && this.cropped) {\n        data = {\n          x: cropBoxData.left - canvasData.left,\n          y: cropBoxData.top - canvasData.top,\n          width: cropBoxData.width,\n          height: cropBoxData.height\n        };\n        var ratio = imageData.width / imageData.naturalWidth;\n        forEach(data, function (n, i) {\n          data[i] = n / ratio;\n        });\n        if (rounded) {\n          // In case rounding off leads to extra 1px in right or bottom border\n          // we should round the top-left corner and the dimension (#343).\n          var bottom = Math.round(data.y + data.height);\n          var right = Math.round(data.x + data.width);\n          data.x = Math.round(data.x);\n          data.y = Math.round(data.y);\n          data.width = right - data.x;\n          data.height = bottom - data.y;\n        }\n      } else {\n        data = {\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0\n        };\n      }\n      if (options.rotatable) {\n        data.rotate = imageData.rotate || 0;\n      }\n      if (options.scalable) {\n        data.scaleX = imageData.scaleX || 1;\n        data.scaleY = imageData.scaleY || 1;\n      }\n      return data;\n    },\n    /**\n     * Set the cropped area position and size with new data\n     * @param {Object} data - The new data.\n     * @returns {Cropper} this\n     */\n    setData: function setData(data) {\n      var options = this.options,\n        imageData = this.imageData,\n        canvasData = this.canvasData;\n      var cropBoxData = {};\n      if (this.ready && !this.disabled && isPlainObject(data)) {\n        var transformed = false;\n        if (options.rotatable) {\n          if (isNumber(data.rotate) && data.rotate !== imageData.rotate) {\n            imageData.rotate = data.rotate;\n            transformed = true;\n          }\n        }\n        if (options.scalable) {\n          if (isNumber(data.scaleX) && data.scaleX !== imageData.scaleX) {\n            imageData.scaleX = data.scaleX;\n            transformed = true;\n          }\n          if (isNumber(data.scaleY) && data.scaleY !== imageData.scaleY) {\n            imageData.scaleY = data.scaleY;\n            transformed = true;\n          }\n        }\n        if (transformed) {\n          this.renderCanvas(true, true);\n        }\n        var ratio = imageData.width / imageData.naturalWidth;\n        if (isNumber(data.x)) {\n          cropBoxData.left = data.x * ratio + canvasData.left;\n        }\n        if (isNumber(data.y)) {\n          cropBoxData.top = data.y * ratio + canvasData.top;\n        }\n        if (isNumber(data.width)) {\n          cropBoxData.width = data.width * ratio;\n        }\n        if (isNumber(data.height)) {\n          cropBoxData.height = data.height * ratio;\n        }\n        this.setCropBoxData(cropBoxData);\n      }\n      return this;\n    },\n    /**\n     * Get the container size data.\n     * @returns {Object} The result container data.\n     */\n    getContainerData: function getContainerData() {\n      return this.ready ? assign({}, this.containerData) : {};\n    },\n    /**\n     * Get the image position and size data.\n     * @returns {Object} The result image data.\n     */\n    getImageData: function getImageData() {\n      return this.sized ? assign({}, this.imageData) : {};\n    },\n    /**\n     * Get the canvas position and size data.\n     * @returns {Object} The result canvas data.\n     */\n    getCanvasData: function getCanvasData() {\n      var canvasData = this.canvasData;\n      var data = {};\n      if (this.ready) {\n        forEach(['left', 'top', 'width', 'height', 'naturalWidth', 'naturalHeight'], function (n) {\n          data[n] = canvasData[n];\n        });\n      }\n      return data;\n    },\n    /**\n     * Set the canvas position and size with new data.\n     * @param {Object} data - The new canvas data.\n     * @returns {Cropper} this\n     */\n    setCanvasData: function setCanvasData(data) {\n      var canvasData = this.canvasData;\n      var aspectRatio = canvasData.aspectRatio;\n      if (this.ready && !this.disabled && isPlainObject(data)) {\n        if (isNumber(data.left)) {\n          canvasData.left = data.left;\n        }\n        if (isNumber(data.top)) {\n          canvasData.top = data.top;\n        }\n        if (isNumber(data.width)) {\n          canvasData.width = data.width;\n          canvasData.height = data.width / aspectRatio;\n        } else if (isNumber(data.height)) {\n          canvasData.height = data.height;\n          canvasData.width = data.height * aspectRatio;\n        }\n        this.renderCanvas(true);\n      }\n      return this;\n    },\n    /**\n     * Get the crop box position and size data.\n     * @returns {Object} The result crop box data.\n     */\n    getCropBoxData: function getCropBoxData() {\n      var cropBoxData = this.cropBoxData;\n      var data;\n      if (this.ready && this.cropped) {\n        data = {\n          left: cropBoxData.left,\n          top: cropBoxData.top,\n          width: cropBoxData.width,\n          height: cropBoxData.height\n        };\n      }\n      return data || {};\n    },\n    /**\n     * Set the crop box position and size with new data.\n     * @param {Object} data - The new crop box data.\n     * @returns {Cropper} this\n     */\n    setCropBoxData: function setCropBoxData(data) {\n      var cropBoxData = this.cropBoxData;\n      var aspectRatio = this.options.aspectRatio;\n      var widthChanged;\n      var heightChanged;\n      if (this.ready && this.cropped && !this.disabled && isPlainObject(data)) {\n        if (isNumber(data.left)) {\n          cropBoxData.left = data.left;\n        }\n        if (isNumber(data.top)) {\n          cropBoxData.top = data.top;\n        }\n        if (isNumber(data.width) && data.width !== cropBoxData.width) {\n          widthChanged = true;\n          cropBoxData.width = data.width;\n        }\n        if (isNumber(data.height) && data.height !== cropBoxData.height) {\n          heightChanged = true;\n          cropBoxData.height = data.height;\n        }\n        if (aspectRatio) {\n          if (widthChanged) {\n            cropBoxData.height = cropBoxData.width / aspectRatio;\n          } else if (heightChanged) {\n            cropBoxData.width = cropBoxData.height * aspectRatio;\n          }\n        }\n        this.renderCropBox();\n      }\n      return this;\n    },\n    /**\n     * Get a canvas drawn the cropped image.\n     * @param {Object} [options={}] - The config options.\n     * @returns {HTMLCanvasElement} - The result canvas.\n     */\n    getCroppedCanvas: function getCroppedCanvas() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (!this.ready || !window.HTMLCanvasElement) {\n        return null;\n      }\n      var canvasData = this.canvasData;\n      var source = getSourceCanvas(this.image, this.imageData, canvasData, options);\n\n      // Returns the source canvas if it is not cropped.\n      if (!this.cropped) {\n        return source;\n      }\n      var _this$getData = this.getData(),\n        initialX = _this$getData.x,\n        initialY = _this$getData.y,\n        initialWidth = _this$getData.width,\n        initialHeight = _this$getData.height;\n      var ratio = source.width / Math.floor(canvasData.naturalWidth);\n      if (ratio !== 1) {\n        initialX *= ratio;\n        initialY *= ratio;\n        initialWidth *= ratio;\n        initialHeight *= ratio;\n      }\n      var aspectRatio = initialWidth / initialHeight;\n      var maxSizes = getAdjustedSizes({\n        aspectRatio: aspectRatio,\n        width: options.maxWidth || Infinity,\n        height: options.maxHeight || Infinity\n      });\n      var minSizes = getAdjustedSizes({\n        aspectRatio: aspectRatio,\n        width: options.minWidth || 0,\n        height: options.minHeight || 0\n      }, 'cover');\n      var _getAdjustedSizes = getAdjustedSizes({\n          aspectRatio: aspectRatio,\n          width: options.width || (ratio !== 1 ? source.width : initialWidth),\n          height: options.height || (ratio !== 1 ? source.height : initialHeight)\n        }),\n        width = _getAdjustedSizes.width,\n        height = _getAdjustedSizes.height;\n      width = Math.min(maxSizes.width, Math.max(minSizes.width, width));\n      height = Math.min(maxSizes.height, Math.max(minSizes.height, height));\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      canvas.width = normalizeDecimalNumber(width);\n      canvas.height = normalizeDecimalNumber(height);\n      context.fillStyle = options.fillColor || 'transparent';\n      context.fillRect(0, 0, width, height);\n      var _options$imageSmoothi = options.imageSmoothingEnabled,\n        imageSmoothingEnabled = _options$imageSmoothi === void 0 ? true : _options$imageSmoothi,\n        imageSmoothingQuality = options.imageSmoothingQuality;\n      context.imageSmoothingEnabled = imageSmoothingEnabled;\n      if (imageSmoothingQuality) {\n        context.imageSmoothingQuality = imageSmoothingQuality;\n      }\n\n      // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D.drawImage\n      var sourceWidth = source.width;\n      var sourceHeight = source.height;\n\n      // Source canvas parameters\n      var srcX = initialX;\n      var srcY = initialY;\n      var srcWidth;\n      var srcHeight;\n\n      // Destination canvas parameters\n      var dstX;\n      var dstY;\n      var dstWidth;\n      var dstHeight;\n      if (srcX <= -initialWidth || srcX > sourceWidth) {\n        srcX = 0;\n        srcWidth = 0;\n        dstX = 0;\n        dstWidth = 0;\n      } else if (srcX <= 0) {\n        dstX = -srcX;\n        srcX = 0;\n        srcWidth = Math.min(sourceWidth, initialWidth + srcX);\n        dstWidth = srcWidth;\n      } else if (srcX <= sourceWidth) {\n        dstX = 0;\n        srcWidth = Math.min(initialWidth, sourceWidth - srcX);\n        dstWidth = srcWidth;\n      }\n      if (srcWidth <= 0 || srcY <= -initialHeight || srcY > sourceHeight) {\n        srcY = 0;\n        srcHeight = 0;\n        dstY = 0;\n        dstHeight = 0;\n      } else if (srcY <= 0) {\n        dstY = -srcY;\n        srcY = 0;\n        srcHeight = Math.min(sourceHeight, initialHeight + srcY);\n        dstHeight = srcHeight;\n      } else if (srcY <= sourceHeight) {\n        dstY = 0;\n        srcHeight = Math.min(initialHeight, sourceHeight - srcY);\n        dstHeight = srcHeight;\n      }\n      var params = [srcX, srcY, srcWidth, srcHeight];\n\n      // Avoid \"IndexSizeError\"\n      if (dstWidth > 0 && dstHeight > 0) {\n        var scale = width / initialWidth;\n        params.push(dstX * scale, dstY * scale, dstWidth * scale, dstHeight * scale);\n      }\n\n      // All the numerical parameters should be integer for `drawImage`\n      // https://github.com/fengyuanchen/cropper/issues/476\n      context.drawImage.apply(context, [source].concat(_toConsumableArray(params.map(function (param) {\n        return Math.floor(normalizeDecimalNumber(param));\n      }))));\n      return canvas;\n    },\n    /**\n     * Change the aspect ratio of the crop box.\n     * @param {number} aspectRatio - The new aspect ratio.\n     * @returns {Cropper} this\n     */\n    setAspectRatio: function setAspectRatio(aspectRatio) {\n      var options = this.options;\n      if (!this.disabled && !isUndefined(aspectRatio)) {\n        // 0 -> NaN\n        options.aspectRatio = Math.max(0, aspectRatio) || NaN;\n        if (this.ready) {\n          this.initCropBox();\n          if (this.cropped) {\n            this.renderCropBox();\n          }\n        }\n      }\n      return this;\n    },\n    /**\n     * Change the drag mode.\n     * @param {string} mode - The new drag mode.\n     * @returns {Cropper} this\n     */\n    setDragMode: function setDragMode(mode) {\n      var options = this.options,\n        dragBox = this.dragBox,\n        face = this.face;\n      if (this.ready && !this.disabled) {\n        var croppable = mode === DRAG_MODE_CROP;\n        var movable = options.movable && mode === DRAG_MODE_MOVE;\n        mode = croppable || movable ? mode : DRAG_MODE_NONE;\n        options.dragMode = mode;\n        setData(dragBox, DATA_ACTION, mode);\n        toggleClass(dragBox, CLASS_CROP, croppable);\n        toggleClass(dragBox, CLASS_MOVE, movable);\n        if (!options.cropBoxMovable) {\n          // Sync drag mode to crop box when it is not movable\n          setData(face, DATA_ACTION, mode);\n          toggleClass(face, CLASS_CROP, croppable);\n          toggleClass(face, CLASS_MOVE, movable);\n        }\n      }\n      return this;\n    }\n  };\n\n  var AnotherCropper = WINDOW.Cropper;\n  var Cropper = /*#__PURE__*/function () {\n    /**\n     * Create a new Cropper.\n     * @param {Element} element - The target element for cropping.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Cropper(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      _classCallCheck(this, Cropper);\n      if (!element || !REGEXP_TAG_NAME.test(element.tagName)) {\n        throw new Error('The first argument is required and must be an <img> or <canvas> element.');\n      }\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.cropped = false;\n      this.disabled = false;\n      this.pointers = {};\n      this.ready = false;\n      this.reloading = false;\n      this.replaced = false;\n      this.sized = false;\n      this.sizing = false;\n      this.init();\n    }\n    _createClass(Cropper, [{\n      key: \"init\",\n      value: function init() {\n        var element = this.element;\n        var tagName = element.tagName.toLowerCase();\n        var url;\n        if (element[NAMESPACE]) {\n          return;\n        }\n        element[NAMESPACE] = this;\n        if (tagName === 'img') {\n          this.isImg = true;\n\n          // e.g.: \"img/picture.jpg\"\n          url = element.getAttribute('src') || '';\n          this.originalUrl = url;\n\n          // Stop when it's a blank image\n          if (!url) {\n            return;\n          }\n\n          // e.g.: \"https://example.com/img/picture.jpg\"\n          url = element.src;\n        } else if (tagName === 'canvas' && window.HTMLCanvasElement) {\n          url = element.toDataURL();\n        }\n        this.load(url);\n      }\n    }, {\n      key: \"load\",\n      value: function load(url) {\n        var _this = this;\n        if (!url) {\n          return;\n        }\n        this.url = url;\n        this.imageData = {};\n        var element = this.element,\n          options = this.options;\n        if (!options.rotatable && !options.scalable) {\n          options.checkOrientation = false;\n        }\n\n        // Only IE10+ supports Typed Arrays\n        if (!options.checkOrientation || !window.ArrayBuffer) {\n          this.clone();\n          return;\n        }\n\n        // Detect the mime type of the image directly if it is a Data URL\n        if (REGEXP_DATA_URL.test(url)) {\n          // Read ArrayBuffer from Data URL of JPEG images directly for better performance\n          if (REGEXP_DATA_URL_JPEG.test(url)) {\n            this.read(dataURLToArrayBuffer(url));\n          } else {\n            // Only a JPEG image may contains Exif Orientation information,\n            // the rest types of Data URLs are not necessary to check orientation at all.\n            this.clone();\n          }\n          return;\n        }\n\n        // 1. Detect the mime type of the image by a XMLHttpRequest.\n        // 2. Load the image as ArrayBuffer for reading orientation if its a JPEG image.\n        var xhr = new XMLHttpRequest();\n        var clone = this.clone.bind(this);\n        this.reloading = true;\n        this.xhr = xhr;\n\n        // 1. Cross origin requests are only supported for protocol schemes:\n        // http, https, data, chrome, chrome-extension.\n        // 2. Access to XMLHttpRequest from a Data URL will be blocked by CORS policy\n        // in some browsers as IE11 and Safari.\n        xhr.onabort = clone;\n        xhr.onerror = clone;\n        xhr.ontimeout = clone;\n        xhr.onprogress = function () {\n          // Abort the request directly if it not a JPEG image for better performance\n          if (xhr.getResponseHeader('content-type') !== MIME_TYPE_JPEG) {\n            xhr.abort();\n          }\n        };\n        xhr.onload = function () {\n          _this.read(xhr.response);\n        };\n        xhr.onloadend = function () {\n          _this.reloading = false;\n          _this.xhr = null;\n        };\n\n        // Bust cache when there is a \"crossOrigin\" property to avoid browser cache error\n        if (options.checkCrossOrigin && isCrossOriginURL(url) && element.crossOrigin) {\n          url = addTimestamp(url);\n        }\n\n        // The third parameter is required for avoiding side-effect (#682)\n        xhr.open('GET', url, true);\n        xhr.responseType = 'arraybuffer';\n        xhr.withCredentials = element.crossOrigin === 'use-credentials';\n        xhr.send();\n      }\n    }, {\n      key: \"read\",\n      value: function read(arrayBuffer) {\n        var options = this.options,\n          imageData = this.imageData;\n\n        // Reset the orientation value to its default value 1\n        // as some iOS browsers will render image with its orientation\n        var orientation = resetAndGetOrientation(arrayBuffer);\n        var rotate = 0;\n        var scaleX = 1;\n        var scaleY = 1;\n        if (orientation > 1) {\n          // Generate a new URL which has the default orientation value\n          this.url = arrayBufferToDataURL(arrayBuffer, MIME_TYPE_JPEG);\n          var _parseOrientation = parseOrientation(orientation);\n          rotate = _parseOrientation.rotate;\n          scaleX = _parseOrientation.scaleX;\n          scaleY = _parseOrientation.scaleY;\n        }\n        if (options.rotatable) {\n          imageData.rotate = rotate;\n        }\n        if (options.scalable) {\n          imageData.scaleX = scaleX;\n          imageData.scaleY = scaleY;\n        }\n        this.clone();\n      }\n    }, {\n      key: \"clone\",\n      value: function clone() {\n        var element = this.element,\n          url = this.url;\n        var crossOrigin = element.crossOrigin;\n        var crossOriginUrl = url;\n        if (this.options.checkCrossOrigin && isCrossOriginURL(url)) {\n          if (!crossOrigin) {\n            crossOrigin = 'anonymous';\n          }\n\n          // Bust cache when there is not a \"crossOrigin\" property (#519)\n          crossOriginUrl = addTimestamp(url);\n        }\n        this.crossOrigin = crossOrigin;\n        this.crossOriginUrl = crossOriginUrl;\n        var image = document.createElement('img');\n        if (crossOrigin) {\n          image.crossOrigin = crossOrigin;\n        }\n        image.src = crossOriginUrl || url;\n        image.alt = element.alt || 'The image to crop';\n        this.image = image;\n        image.onload = this.start.bind(this);\n        image.onerror = this.stop.bind(this);\n        addClass(image, CLASS_HIDE);\n        element.parentNode.insertBefore(image, element.nextSibling);\n      }\n    }, {\n      key: \"start\",\n      value: function start() {\n        var _this2 = this;\n        var image = this.image;\n        image.onload = null;\n        image.onerror = null;\n        this.sizing = true;\n\n        // Match all browsers that use WebKit as the layout engine in iOS devices,\n        // such as Safari for iOS, Chrome for iOS, and in-app browsers.\n        var isIOSWebKit = WINDOW.navigator && /(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(WINDOW.navigator.userAgent);\n        var done = function done(naturalWidth, naturalHeight) {\n          assign(_this2.imageData, {\n            naturalWidth: naturalWidth,\n            naturalHeight: naturalHeight,\n            aspectRatio: naturalWidth / naturalHeight\n          });\n          _this2.initialImageData = assign({}, _this2.imageData);\n          _this2.sizing = false;\n          _this2.sized = true;\n          _this2.build();\n        };\n\n        // Most modern browsers (excepts iOS WebKit)\n        if (image.naturalWidth && !isIOSWebKit) {\n          done(image.naturalWidth, image.naturalHeight);\n          return;\n        }\n        var sizingImage = document.createElement('img');\n        var body = document.body || document.documentElement;\n        this.sizingImage = sizingImage;\n        sizingImage.onload = function () {\n          done(sizingImage.width, sizingImage.height);\n          if (!isIOSWebKit) {\n            body.removeChild(sizingImage);\n          }\n        };\n        sizingImage.src = image.src;\n\n        // iOS WebKit will convert the image automatically\n        // with its orientation once append it into DOM (#279)\n        if (!isIOSWebKit) {\n          sizingImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n          body.appendChild(sizingImage);\n        }\n      }\n    }, {\n      key: \"stop\",\n      value: function stop() {\n        var image = this.image;\n        image.onload = null;\n        image.onerror = null;\n        image.parentNode.removeChild(image);\n        this.image = null;\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (!this.sized || this.ready) {\n          return;\n        }\n        var element = this.element,\n          options = this.options,\n          image = this.image;\n\n        // Create cropper elements\n        var container = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var cropper = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var canvas = cropper.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        var dragBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-drag-box\"));\n        var cropBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-crop-box\"));\n        var face = cropBox.querySelector(\".\".concat(NAMESPACE, \"-face\"));\n        this.container = container;\n        this.cropper = cropper;\n        this.canvas = canvas;\n        this.dragBox = dragBox;\n        this.cropBox = cropBox;\n        this.viewBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-view-box\"));\n        this.face = face;\n        canvas.appendChild(image);\n\n        // Hide the original image\n        addClass(element, CLASS_HIDDEN);\n\n        // Inserts the cropper after to the current image\n        container.insertBefore(cropper, element.nextSibling);\n\n        // Show the hidden image\n        removeClass(image, CLASS_HIDE);\n        this.initPreview();\n        this.bind();\n        options.initialAspectRatio = Math.max(0, options.initialAspectRatio) || NaN;\n        options.aspectRatio = Math.max(0, options.aspectRatio) || NaN;\n        options.viewMode = Math.max(0, Math.min(3, Math.round(options.viewMode))) || 0;\n        addClass(cropBox, CLASS_HIDDEN);\n        if (!options.guides) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-dashed\")), CLASS_HIDDEN);\n        }\n        if (!options.center) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-center\")), CLASS_HIDDEN);\n        }\n        if (options.background) {\n          addClass(cropper, \"\".concat(NAMESPACE, \"-bg\"));\n        }\n        if (!options.highlight) {\n          addClass(face, CLASS_INVISIBLE);\n        }\n        if (options.cropBoxMovable) {\n          addClass(face, CLASS_MOVE);\n          setData(face, DATA_ACTION, ACTION_ALL);\n        }\n        if (!options.cropBoxResizable) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-line\")), CLASS_HIDDEN);\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-point\")), CLASS_HIDDEN);\n        }\n        this.render();\n        this.ready = true;\n        this.setDragMode(options.dragMode);\n        if (options.autoCrop) {\n          this.crop();\n        }\n        this.setData(options.data);\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n        dispatchEvent(element, EVENT_READY);\n      }\n    }, {\n      key: \"unbuild\",\n      value: function unbuild() {\n        if (!this.ready) {\n          return;\n        }\n        this.ready = false;\n        this.unbind();\n        this.resetPreview();\n        var parentNode = this.cropper.parentNode;\n        if (parentNode) {\n          parentNode.removeChild(this.cropper);\n        }\n        removeClass(this.element, CLASS_HIDDEN);\n      }\n    }, {\n      key: \"uncreate\",\n      value: function uncreate() {\n        if (this.ready) {\n          this.unbuild();\n          this.ready = false;\n          this.cropped = false;\n        } else if (this.sizing) {\n          this.sizingImage.onload = null;\n          this.sizing = false;\n          this.sized = false;\n        } else if (this.reloading) {\n          this.xhr.onabort = null;\n          this.xhr.abort();\n        } else if (this.image) {\n          this.stop();\n        }\n      }\n\n      /**\n       * Get the no conflict cropper class.\n       * @returns {Cropper} The cropper class.\n       */\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Cropper = AnotherCropper;\n        return Cropper;\n      }\n\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n    return Cropper;\n  }();\n  assign(Cropper.prototype, render, preview, events, handlers, change, methods);\n\n  return Cropper;\n\n}));\n","\n/*! image-blob-reduce 4.1.0 https://github.com/nodeca/image-blob-reduce @license MIT */\nfunction commonjsRequire (path) {\n\tthrow new Error('Could not dynamically require \"' + path + '\". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');\n}\n\nvar utils$1 = {};\n\nutils$1.assign = function assign(to) {\n  var from;\n\n  for (var s = 1; s < arguments.length; s++) {\n    from = Object(arguments[s]);\n\n    for (var key in from) {\n      if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n    }\n  }\n\n  return to;\n};\n\n\nfunction pick(from, props) {\n  var to = {};\n\n  props.forEach(function (key) {\n    if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n  });\n\n  return to;\n}\n\n\nfunction pick_pica_resize_options(from) {\n  return pick(from, [\n    'alpha',\n    'unsharpAmount',\n    'unsharpRadius',\n    'unsharpThreshold',\n    'cancelToken'\n  ]);\n}\n\n\nutils$1.pick = pick;\nutils$1.pick_pica_resize_options = pick_pica_resize_options;\n\nvar pica$1 = {exports: {}};\n\n/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\n(function (module, exports) {\n(function(f){{module.exports=f();}})(function(){return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof commonjsRequire&&commonjsRequire;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t);}return n[i].exports}for(var u=\"function\"==typeof commonjsRequire&&commonjsRequire,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(_dereq_,module,exports){\n\nvar Multimath = _dereq_('multimath');\n\nvar mm_unsharp_mask = _dereq_('./mm_unsharp_mask');\n\nvar mm_resize = _dereq_('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n  Multimath.call(this, features);\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm()\n  };\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\nMathLib.prototype = Object.create(Multimath.prototype);\nMathLib.prototype.constructor = MathLib;\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"./mm_unsharp_mask\":9,\"multimath\":19}],2:[function(_dereq_,module,exports){\n//var FIXED_FRAC_BITS = 14;\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clampNegative(i) {\n  return i >= 0 ? i : 0;\n} // Convolve image data in horizontal direction. Can be used for:\n//\n// 1. bitmap with premultiplied alpha\n// 2. bitmap without alpha (all values 255)\n//\n// Notes:\n//\n// - output is transposed\n// - output resolution is ~15 bits per channel(for better precision).\n//\n\n\nfunction convolveHor(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHor()`\n//\n\n\nfunction convolveVert(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Sync with premultiplied version for exact result match\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Bring this value back in range + round result.\n      //\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14);\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Premultiply & convolve image data in horizontal direction. Can be used for:\n//\n// - Any bitmap data, extracted with `.getImageData()` method (with\n//   non-premultiplied alpha)\n//\n// For images without alpha channel this method is slower than `convolveHor()`\n//\n\n\nfunction convolveHorWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a, alpha;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        alpha = src[srcPtr + 3];\n        a = a + filterVal * alpha | 0;\n        b = b + filterVal * src[srcPtr + 2] * alpha | 0;\n        g = g + filterVal * src[srcPtr + 1] * alpha | 0;\n        r = r + filterVal * src[srcPtr] * alpha | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Premultiply is (* alpha / 255).\n      // Postpone division for better performance\n\n\n      b = b / 255 | 0;\n      g = g / 255 | 0;\n      r = r / 255 | 0; // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHorWithPre()`\n//\n\n\nfunction convolveVertWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Downscale to leave room for un-premultiply\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Un-premultiply\n\n      a = clampTo8(a + (1 << 13) >> 14);\n\n      if (a > 0) {\n        r = r * 255 / a | 0;\n        g = g * 255 / a | 0;\n        b = b * 255 / a | 0;\n      } // Bring this value back in range + round result.\n      // Shift value = FIXED_FRAC_BITS + 7\n      //\n\n\n      dest[destOffset + 3] = a;\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHor: convolveHor,\n  convolveVert: convolveVert,\n  convolveHorWithPre: convolveHorWithPre,\n  convolveVertWithPre: convolveVertWithPre\n};\n\n},{}],3:[function(_dereq_,module,exports){\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],4:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name: 'resize',\n  fn: _dereq_('./resize'),\n  wasm_fn: _dereq_('./resize_wasm'),\n  wasm_src: _dereq_('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nvar _require = _dereq_('./convolve'),\n    convolveHor = _require.convolveHor,\n    convolveVert = _require.convolveVert,\n    convolveHorWithPre = _require.convolveHorWithPre,\n    convolveVertWithPre = _require.convolveVertWithPre;\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY);\n  var tmp = new Uint16Array(destW * srcH * 4); // Autodetect if alpha channel exists, and use appropriate method\n\n  if (hasAlpha(src, srcW, srcH)) {\n    convolveHorWithPre(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVertWithPre(tmp, dest, srcH, destW, destH, filtersY);\n  } else {\n    convolveHor(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVert(tmp, dest, srcH, destW, destH, filtersY);\n    resetAlpha(dest, destW, destH);\n  }\n\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(_dereq_,module,exports){\n\nvar FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(filter, srcSize, destSize, scale, offset) {\n  var filterFunction = FILTER_INFO.filter[filter].fn;\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n  // Filter window (averaging interval), scaled to src image\n\n  var srcWindow = FILTER_INFO.filter[filter].win / scaleClamped;\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n  var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n    total = 0.0; // Fill filter values for calculated range\n\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    } // Normalize filter, convert to fixed point and accumulate conversion error\n\n\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    } // Compensate normalization error, to minimize brightness drift\n\n\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(_dereq_,module,exports){\n\nvar filter = {\n  // Nearest neibor\n  box: {\n    win: 0.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n      return x < 0.5 ? 1.0 : 0.0;\n    }\n  },\n  // // Hamming\n  hamming: {\n    win: 1.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 1.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n    }\n  },\n  // Lanczos, win = 2\n  lanczos2: {\n    win: 2.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n    }\n  },\n  // Lanczos, win = 3\n  lanczos3: {\n    win: 3.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 3.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n    }\n  },\n  // Magic Kernel Sharp 2013, win = 2.5\n  // http://johncostella.com/magic/\n  mks2013: {\n    win: 2.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.5) {\n        return 0.0;\n      }\n\n      if (x >= 1.5) {\n        return -0.125 * (x - 2.5) * (x - 2.5);\n      }\n\n      if (x >= 0.5) {\n        return 0.25 * (4 * x * x - 11 * x + 7);\n      }\n\n      return 1.0625 - 1.75 * x * x;\n    }\n  }\n};\nmodule.exports = {\n  filter: filter,\n  // Legacy mapping\n  f2q: {\n    box: 0,\n    hamming: 1,\n    lanczos2: 2,\n    lanczos3: 3\n  },\n  q2f: ['box', 'hamming', 'lanczos2', 'lanczos3']\n};\n\n},{}],8:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true; // should not crash everything on module load in old browsers\n\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n  var src_offset = 0;\n  var src_size = Math.max(src.byteLength, dest.byteLength); // buffer between convolve passes\n\n  var tmp_offset = this.__align(src_offset + src_size);\n\n  var tmp_size = srcH * destW * 4 * 2; // 2 bytes per channel\n\n  var filtersX_offset = this.__align(tmp_offset + tmp_size);\n\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes); //\n  // Fill memory block with data to process\n  //\n\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset); // Now call webassembly method\n  // emsdk does method names with '_'\n\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n\n  if (hasAlpha(src, srcW, srcH)) {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 1);\n  } else {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 0);\n    resetAlpha(dest, destW, destH);\n  } //\n  // Copy data back to typed array\n  //\n  // 32-bit copy is much faster in chrome\n\n\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW));\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name: 'unsharp_mask',\n  fn: _dereq_('./unsharp_mask'),\n  wasm_fn: _dereq_('./unsharp_mask_wasm'),\n  wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":10,\"./unsharp_mask_wasm\":11,\"./unsharp_mask_wasm_base64\":12}],10:[function(_dereq_,module,exports){\n\nvar glur_mono16 = _dereq_('glur/mono16');\n\nfunction hsv_v16(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, max;\n\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = r >= g && r >= b ? r : g >= b && g >= r ? g : b;\n    out[i] = max << 8;\n  }\n\n  return out;\n}\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var v1, v2, vmul;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var brightness = hsv_v16(img, width, height);\n  var blured = new Uint16Array(brightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n  var amountFp = amount / 100 * 0x1000 + 0.5 | 0;\n  var thresholdFp = threshold << 8;\n  var size = width * height;\n  /* eslint-disable indent */\n\n  for (var i = 0; i < size; i++) {\n    v1 = brightness[i];\n    diff = v1 - blured[i];\n\n    if (Math.abs(diff) >= thresholdFp) {\n      // add unsharp mask to the brightness channel\n      v2 = v1 + (amountFp * diff + 0x800 >> 12); // Both v1 and v2 are within [0.0 .. 255.0] (0000-FF00) range, never going into\n      // [255.003 .. 255.996] (FF01-FFFF). This allows to round this value as (x+.5)|0\n      // later without overflowing.\n\n      v2 = v2 > 0xff00 ? 0xff00 : v2;\n      v2 = v2 < 0x0000 ? 0x0000 : v2; // Avoid division by 0. V=0 means rgb(0,0,0), unsharp with unsharpAmount>0 cannot\n      // change this value (because diff between colors gets inflated), so no need to verify correctness.\n\n      v1 = v1 !== 0 ? v1 : 1; // Multiplying V in HSV model by a constant is equivalent to multiplying each component\n      // in RGB by the same constant (same for HSL), see also:\n      // https://beesbuzz.biz/code/16-hsv-color-transforms\n\n      vmul = (v2 << 12) / v1 | 0; // Result will be in [0..255] range because:\n      //  - all numbers are positive\n      //  - r,g,b <= (v1/256)\n      //  - r,g,b,(v1/256),(v2/256) <= 255\n      // So highest this number can get is X*255/X+0.5=255.5 which is < 256 and rounds down.\n\n      iTimes4 = i * 4;\n      img[iTimes4] = img[iTimes4] * vmul + 0x800 >> 12; // R\n\n      img[iTimes4 + 1] = img[iTimes4 + 1] * vmul + 0x800 >> 12; // G\n\n      img[iTimes4 + 2] = img[iTimes4 + 2] * vmul + 0x800 >> 12; // B\n    }\n  }\n};\n\n},{\"glur/mono16\":18}],11:[function(_dereq_,module,exports){\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n  var img_bytes_cnt = pixels * 4;\n  var hsv_bytes_cnt = pixels * 2;\n  var blur_bytes_cnt = pixels * 2;\n  var blur_line_byte_cnt = Math.max(width, height) * 4; // float32 array\n\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset = 0;\n  var hsv_offset = img_bytes_cnt;\n  var blur_offset = hsv_offset + hsv_bytes_cnt;\n  var blur_tmp_offset = blur_offset + blur_bytes_cnt;\n  var blur_line_offset = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance('unsharp_mask', img_bytes_cnt + hsv_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt, {\n    exp: Math.exp\n  }); // 32-bit copy is much faster in chrome\n\n\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32); // HSL\n\n  var fn = instance.exports.hsv_v16 || instance.exports._hsv_v16;\n  fn(img_offset, hsv_offset, width, height); // BLUR\n\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsv_offset, blur_offset, blur_tmp_offset, blur_line_offset, blur_coeffs_offset, width, height, radius); // UNSHARP\n\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsv_offset, blur_offset, width, height, amount, threshold); // 32-bit copy is much faster in chrome\n\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],12:[function(_dereq_,module,exports){\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],13:[function(_dereq_,module,exports){\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],14:[function(_dereq_,module,exports){\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],15:[function(_dereq_,module,exports){\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n\n      if (y < 0) {\n        y = 0;\n      }\n\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],16:[function(_dereq_,module,exports){\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  var cname = objClass(element);\n  return cname === '[object HTMLCanvasElement]'\n  /* browser */\n  || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n  /* node-canvas */\n  ;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.isImageBitmap = function isImageBitmap(element) {\n  return objClass(element) === '[object ImageBitmap]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n\n    case 1:\n      return 'low';\n\n    case 2:\n      return 'medium';\n  }\n\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support(createCanvas) {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined') {\n      return false;\n    }\n\n    var c = createCanvas(100, 100);\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  })[\"catch\"](function () {\n    return false;\n  });\n};\n\nmodule.exports.worker_offscreen_canvas_support = function worker_offscreen_canvas_support() {\n  return new Promise(function (resolve, reject) {\n    if (typeof OffscreenCanvas === 'undefined') {\n      // if OffscreenCanvas is present, we assume browser supports Worker and built-in Promise as well\n      resolve(false);\n      return;\n    }\n\n    function workerPayload(self) {\n      if (typeof createImageBitmap === 'undefined') {\n        self.postMessage(false);\n        return;\n      }\n\n      Promise.resolve().then(function () {\n        var canvas = new OffscreenCanvas(10, 10); // test that 2d context can be used in worker\n\n        var ctx = canvas.getContext('2d');\n        ctx.rect(0, 0, 1, 1); // test that cib can be used to return image bitmap from worker\n\n        return createImageBitmap(canvas, 0, 0, 1, 1);\n      }).then(function () {\n        return self.postMessage(true);\n      }, function () {\n        return self.postMessage(false);\n      });\n    }\n\n    var code = btoa(\"(\".concat(workerPayload.toString(), \")(self);\"));\n    var w = new Worker(\"data:text/javascript;base64,\".concat(code));\n\n    w.onmessage = function (ev) {\n      return resolve(ev.data);\n    };\n\n    w.onerror = reject;\n  }).then(function (result) {\n    return result;\n  }, function () {\n    return false;\n  });\n}; // Check if canvas.getContext('2d').getImageData can be used,\n// FireFox randomizes the output of that function in `privacy.resistFingerprinting` mode\n\n\nmodule.exports.can_use_canvas = function can_use_canvas(createCanvas) {\n  var usable = false;\n\n  try {\n    var canvas = createCanvas(2, 1);\n    var ctx = canvas.getContext('2d');\n    var d = ctx.createImageData(2, 1);\n    d.data[0] = 12;\n    d.data[1] = 23;\n    d.data[2] = 34;\n    d.data[3] = 255;\n    d.data[4] = 45;\n    d.data[5] = 56;\n    d.data[6] = 67;\n    d.data[7] = 255;\n    ctx.putImageData(d, 0, 0);\n    d = null;\n    d = ctx.getImageData(0, 0, 2, 1);\n\n    if (d.data[0] === 12 && d.data[1] === 23 && d.data[2] === 34 && d.data[3] === 255 && d.data[4] === 45 && d.data[5] === 56 && d.data[6] === 67 && d.data[7] === 255) {\n      usable = true;\n    }\n  } catch (err) {}\n\n  return usable;\n}; // Check if createImageBitmap(img, sx, sy, sw, sh) signature works correctly\n// with JPEG images oriented with Exif;\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n// TODO: remove after it's fixed in chrome for at least 2 releases\n\n\nmodule.exports.cib_can_use_region = function cib_can_use_region() {\n  return new Promise(function (resolve) {\n    if (typeof createImageBitmap === 'undefined') {\n      resolve(false);\n      return;\n    }\n\n    var image = new Image();\n    image.src = 'data:image/jpeg;base64,' + '/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAA' + 'AABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9' + 'sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRc' + 'ZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoa' + 'GhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRA' + 'f/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAA' + 'IQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAA' + 'AAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIB' + 'AT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAA' + 'AAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAA' + 'AAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQ' + 'QAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';\n\n    image.onload = function () {\n      createImageBitmap(image, 0, 0, image.width, image.height).then(function (bitmap) {\n        if (bitmap.width === image.width && bitmap.height === image.height) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      }, function () {\n        return resolve(false);\n      });\n    };\n\n    image.onerror = function () {\n      return resolve(false);\n    };\n  });\n};\n\n},{}],17:[function(_dereq_,module,exports){\n\nmodule.exports = function () {\n  var MathLib = _dereq_('./mathlib');\n\n  var mathLib;\n  /* eslint-disable no-undef */\n\n  onmessage = function onmessage(ev) {\n    var tileOpts = ev.data.opts;\n\n    if (!tileOpts.src && tileOpts.srcBitmap) {\n      var canvas = new OffscreenCanvas(tileOpts.width, tileOpts.height);\n      var ctx = canvas.getContext('2d');\n      ctx.drawImage(tileOpts.srcBitmap, 0, 0);\n      tileOpts.src = ctx.getImageData(0, 0, tileOpts.width, tileOpts.height).data;\n      canvas.width = canvas.height = 0;\n      canvas = null;\n      tileOpts.srcBitmap.close();\n      tileOpts.srcBitmap = null; // Temporary force out data to typed array, because Chrome have artefacts\n      // https://github.com/nodeca/pica/issues/223\n      // returnBitmap = true;\n    }\n\n    if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n\n    var data = mathLib.resizeAndUnsharp(tileOpts);\n\n    {\n      postMessage({\n        data: data\n      }, [data.buffer]);\n    }\n  };\n};\n\n},{\"./mathlib\":1}],18:[function(_dereq_,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height);\n  convolveMono16(out, src, tmp_line, coeff, height, width);\n}\n\nmodule.exports = blurMono16;\n\n},{}],19:[function(_dereq_,module,exports){\n\n\nvar assign         = _dereq_('object-assign');\nvar base64decode   = _dereq_('./lib/base64decode');\nvar hasWebAssembly = _dereq_('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.has_wasm = hasWebAssembly;\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n    this[module.name] = module.wasm_fn;\n  } else {\n    this[module.name] = module.fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":20,\"./lib/wa_detect\":21,\"object-assign\":22}],20:[function(_dereq_,module,exports){\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],21:[function(_dereq_,module,exports){\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],22:[function(_dereq_,module,exports){\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],23:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/index.js\":[function(_dereq_,module,exports){\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar assign = _dereq_('object-assign');\n\nvar webworkify = _dereq_('webworkify');\n\nvar MathLib = _dereq_('./lib/mathlib');\n\nvar Pool = _dereq_('./lib/pool');\n\nvar utils = _dereq_('./lib/utils');\n\nvar worker = _dereq_('./lib/worker');\n\nvar createStages = _dereq_('./lib/stepper');\n\nvar createRegions = _dereq_('./lib/tiler');\n\nvar filter_info = _dereq_('./lib/mm_resize/resize_filter_info'); // Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\n\n\nvar singletones = {};\nvar NEED_SAFARI_FIX = false;\n\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\n\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000,\n  createCanvas: function createCanvas(width, height) {\n    var tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    return tmpCanvas;\n  }\n};\nvar DEFAULT_RESIZE_OPTS = {\n  filter: 'mks2013',\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\nvar CAN_NEW_IMAGE_DATA = false;\nvar CAN_CREATE_IMAGE_BITMAP = false;\nvar CAN_USE_CANVAS_GET_IMAGE_DATA = false;\nvar CAN_USE_OFFSCREEN_CANVAS = false;\nvar CAN_USE_CIB_REGION_FOR_IMAGE = false;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n// API methods\n\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n  var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n  this.features = {\n    js: false,\n    // pure JS implementation, can be disabled for testing\n    wasm: false,\n    // webassembly implementation for heavy functions\n    cib: false,\n    // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n\n  };\n  this.__workersPool = null; // Store requested features for webworkers\n\n  this.__requested_features = [];\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n  if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n    try {\n      /* eslint-disable no-new */\n      new ImageData(new Uint8ClampedArray(400), 10, 10);\n      CAN_NEW_IMAGE_DATA = true;\n    } catch (__) {}\n  } // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n\n  if (typeof ImageBitmap !== 'undefined') {\n    if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n      CAN_CREATE_IMAGE_BITMAP = true;\n    } else {\n      this.debug('ImageBitmap does not support .close(), disabled');\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n  this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = _dereq_('webworkify')(function () {});\n\n        wkr.terminate();\n        this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n        var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  }\n\n  CAN_USE_CANVAS_GET_IMAGE_DATA = utils.can_use_canvas(this.options.createCanvas);\n  var checkOffscreenCanvas;\n\n  if (CAN_CREATE_IMAGE_BITMAP && CAN_NEW_IMAGE_DATA && features.indexOf('ww') !== -1) {\n    checkOffscreenCanvas = utils.worker_offscreen_canvas_support();\n  } else {\n    checkOffscreenCanvas = Promise.resolve(false);\n  }\n\n  checkOffscreenCanvas = checkOffscreenCanvas.then(function (result) {\n    CAN_USE_OFFSCREEN_CANVAS = result;\n  }); // we use createImageBitmap to crop image data and pass it to workers,\n  // so need to check whether function works correctly;\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n\n  var checkCibRegion = utils.cib_can_use_region().then(function (result) {\n    CAN_USE_CIB_REGION_FOR_IMAGE = result;\n  }); // Init math lib. That's async because can load some\n\n  this.__initPromise = Promise.all([initMath, checkCibResize, checkOffscreenCanvas, checkCibRegion]).then(function () {\n    return _this;\n  });\n  return this.__initPromise;\n}; // Call resizer in webworker or locally, depending on config\n\n\nPica.prototype.__invokeResize = function (tileOpts, opts) {\n  var _this2 = this;\n\n  // Share cache between calls:\n  //\n  // - wasm instance\n  // - wasm memory object\n  //\n  opts.__mathCache = opts.__mathCache || {};\n  return Promise.resolve().then(function () {\n    if (!_this2.features.ww) {\n      // not possible to have ImageBitmap here if user disabled WW\n      return {\n        data: _this2.__mathlib.resizeAndUnsharp(tileOpts, opts.__mathCache)\n      };\n    }\n\n    return new Promise(function (resolve, reject) {\n      var w = _this2.__workersPool.acquire();\n\n      if (opts.cancelToken) opts.cancelToken[\"catch\"](function (err) {\n        return reject(err);\n      });\n\n      w.value.onmessage = function (ev) {\n        w.release();\n        if (ev.data.err) reject(ev.data.err);else resolve(ev.data);\n      };\n\n      var transfer = [];\n      if (tileOpts.src) transfer.push(tileOpts.src.buffer);\n      if (tileOpts.srcBitmap) transfer.push(tileOpts.srcBitmap);\n      w.value.postMessage({\n        opts: tileOpts,\n        features: _this2.__requested_features,\n        preload: {\n          wasm_nodule: _this2.__mathlib.__\n        }\n      }, transfer);\n    });\n  });\n}; // this function can return promise if createImageBitmap is used\n\n\nPica.prototype.__extractTileData = function (tile, from, opts, stageEnv, extractTo) {\n  if (this.features.ww && CAN_USE_OFFSCREEN_CANVAS && ( // createImageBitmap doesn't work for images (Image, ImageBitmap) with Exif orientation in Chrome,\n  // can use canvas because canvas doesn't have orientation;\n  // see https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n  utils.isCanvas(from) || CAN_USE_CIB_REGION_FOR_IMAGE)) {\n    this.debug('Create tile for OffscreenCanvas');\n    return createImageBitmap(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height).then(function (bitmap) {\n      extractTo.srcBitmap = bitmap;\n      return extractTo;\n    });\n  } // Extract tile RGBA buffer, depending on input type\n\n\n  if (utils.isCanvas(from)) {\n    if (!stageEnv.srcCtx) stageEnv.srcCtx = from.getContext('2d'); // If input is Canvas - extract region data directly\n\n    this.debug('Get tile pixel data');\n    extractTo.src = stageEnv.srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height).data;\n    return extractTo;\n  } // If input is Image or decoded to ImageBitmap,\n  // draw region to temporary canvas and extract data from it\n  //\n  // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n  //\n\n\n  this.debug('Draw tile imageBitmap/image to temporary canvas');\n  var tmpCanvas = this.options.createCanvas(tile.width, tile.height);\n  var tmpCtx = tmpCanvas.getContext('2d');\n  tmpCtx.globalCompositeOperation = 'copy';\n  tmpCtx.drawImage(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n  this.debug('Get tile pixel data');\n  extractTo.src = tmpCtx.getImageData(0, 0, tile.width, tile.height).data; // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n\n  tmpCanvas.width = tmpCanvas.height = 0;\n  return extractTo;\n};\n\nPica.prototype.__landTileData = function (tile, result, stageEnv) {\n  var toImageData;\n  this.debug('Convert raw rgba tile result to ImageData');\n\n  if (result.bitmap) {\n    stageEnv.toCtx.drawImage(result.bitmap, tile.toX, tile.toY);\n    return null;\n  }\n\n  if (CAN_NEW_IMAGE_DATA) {\n    // this branch is for modern browsers\n    // If `new ImageData()` & Uint8ClampedArray suported\n    toImageData = new ImageData(new Uint8ClampedArray(result.data), tile.toWidth, tile.toHeight);\n  } else {\n    // fallback for `node-canvas` and old browsers\n    // (IE11 has ImageData but does not support `new ImageData()`)\n    toImageData = stageEnv.toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n    if (toImageData.data.set) {\n      toImageData.data.set(result.data);\n    } else {\n      // IE9 don't have `.set()`\n      for (var i = toImageData.data.length - 1; i >= 0; i--) {\n        toImageData.data[i] = result.data[i];\n      }\n    }\n  }\n\n  this.debug('Draw tile');\n\n  if (NEED_SAFARI_FIX) {\n    // Safari draws thin white stripes between tiles without this fix\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n  } else {\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n  }\n\n  return null;\n};\n\nPica.prototype.__tileAndResize = function (from, to, opts) {\n  var _this3 = this;\n\n  var stageEnv = {\n    srcCtx: null,\n    srcImageBitmap: null,\n    isImageBitmapReused: false,\n    toCtx: null\n  };\n\n  var processTile = function processTile(tile) {\n    return _this3.__limit(function () {\n      if (opts.canceled) return opts.cancelToken;\n      var tileOpts = {\n        width: tile.width,\n        height: tile.height,\n        toWidth: tile.toWidth,\n        toHeight: tile.toHeight,\n        scaleX: tile.scaleX,\n        scaleY: tile.scaleY,\n        offsetX: tile.offsetX,\n        offsetY: tile.offsetY,\n        filter: opts.filter,\n        unsharpAmount: opts.unsharpAmount,\n        unsharpRadius: opts.unsharpRadius,\n        unsharpThreshold: opts.unsharpThreshold\n      };\n\n      _this3.debug('Invoke resize math');\n\n      return Promise.resolve(tileOpts).then(function (tileOpts) {\n        return _this3.__extractTileData(tile, from, opts, stageEnv, tileOpts);\n      }).then(function (tileOpts) {\n        _this3.debug('Invoke resize math');\n\n        return _this3.__invokeResize(tileOpts, opts);\n      }).then(function (result) {\n        if (opts.canceled) return opts.cancelToken;\n        stageEnv.srcImageData = null;\n        return _this3.__landTileData(tile, result, stageEnv);\n      });\n    });\n  }; // Need to normalize data source first. It can be canvas or image.\n  // If image - try to decode in background if possible\n\n\n  return Promise.resolve().then(function () {\n    stageEnv.toCtx = to.getContext('2d');\n    if (utils.isCanvas(from)) return null;\n\n    if (utils.isImageBitmap(from)) {\n      stageEnv.srcImageBitmap = from;\n      stageEnv.isImageBitmapReused = true;\n      return null;\n    }\n\n    if (utils.isImage(from)) {\n      // try do decode image in background for faster next operations;\n      // if we're using offscreen canvas, cib is called per tile, so not needed here\n      if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n      _this3.debug('Decode image via createImageBitmap');\n\n      return createImageBitmap(from).then(function (imageBitmap) {\n        stageEnv.srcImageBitmap = imageBitmap;\n      }) // Suppress error to use fallback, if method fails\n      // https://github.com/nodeca/pica/issues/190\n\n      /* eslint-disable no-unused-vars */\n      [\"catch\"](function (e) {\n        return null;\n      });\n    }\n\n    throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n  }).then(function () {\n    if (opts.canceled) return opts.cancelToken;\n\n    _this3.debug('Calculate tiles'); //\n    // Here we are with \"normalized\" source,\n    // follow to tiling\n    //\n\n\n    var regions = createRegions({\n      width: opts.width,\n      height: opts.height,\n      srcTileSize: _this3.options.tile,\n      toWidth: opts.toWidth,\n      toHeight: opts.toHeight,\n      destTileBorder: opts.__destTileBorder\n    });\n    var jobs = regions.map(function (tile) {\n      return processTile(tile);\n    });\n\n    function cleanup(stageEnv) {\n      if (stageEnv.srcImageBitmap) {\n        if (!stageEnv.isImageBitmapReused) stageEnv.srcImageBitmap.close();\n        stageEnv.srcImageBitmap = null;\n      }\n    }\n\n    _this3.debug('Process tiles');\n\n    return Promise.all(jobs).then(function () {\n      _this3.debug('Finished!');\n\n      cleanup(stageEnv);\n      return to;\n    }, function (err) {\n      cleanup(stageEnv);\n      throw err;\n    });\n  });\n};\n\nPica.prototype.__processStages = function (stages, from, to, opts) {\n  var _this4 = this;\n\n  if (opts.canceled) return opts.cancelToken;\n\n  var _stages$shift = stages.shift(),\n      _stages$shift2 = _slicedToArray(_stages$shift, 2),\n      toWidth = _stages$shift2[0],\n      toHeight = _stages$shift2[1];\n\n  var isLastStage = stages.length === 0; // Optimization for legacy filters -\n  // only use user-defined quality for the last stage,\n  // use simpler (Hamming) filter for the first stages where\n  // scale factor is large enough (more than 2-3)\n  //\n  // For advanced filters (mks2013 and custom) - skip optimization,\n  // because need to apply sharpening every time\n\n  var filter;\n  if (isLastStage || filter_info.q2f.indexOf(opts.filter) < 0) filter = opts.filter;else if (opts.filter === 'box') filter = 'box';else filter = 'hamming';\n  opts = assign({}, opts, {\n    toWidth: toWidth,\n    toHeight: toHeight,\n    filter: filter\n  });\n  var tmpCanvas;\n\n  if (!isLastStage) {\n    // create temporary canvas\n    tmpCanvas = this.options.createCanvas(toWidth, toHeight);\n  }\n\n  return this.__tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n    if (isLastStage) return to;\n    opts.width = toWidth;\n    opts.height = toHeight;\n    return _this4.__processStages(stages, tmpCanvas, to, opts);\n  }).then(function (res) {\n    if (tmpCanvas) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      tmpCanvas.width = tmpCanvas.height = 0;\n    }\n\n    return res;\n  });\n};\n\nPica.prototype.__resizeViaCreateImageBitmap = function (from, to, opts) {\n  var _this5 = this;\n\n  var toCtx = to.getContext('2d');\n  this.debug('Resize via createImageBitmap()');\n  return createImageBitmap(from, {\n    resizeWidth: opts.toWidth,\n    resizeHeight: opts.toHeight,\n    resizeQuality: utils.cib_quality_name(filter_info.f2q[opts.filter])\n  }).then(function (imageBitmap) {\n    if (opts.canceled) return opts.cancelToken; // if no unsharp - draw directly to output canvas\n\n    if (!opts.unsharpAmount) {\n      toCtx.drawImage(imageBitmap, 0, 0);\n      imageBitmap.close();\n      toCtx = null;\n\n      _this5.debug('Finished!');\n\n      return to;\n    }\n\n    _this5.debug('Unsharp result');\n\n    var tmpCanvas = _this5.options.createCanvas(opts.toWidth, opts.toHeight);\n\n    var tmpCtx = tmpCanvas.getContext('2d');\n    tmpCtx.drawImage(imageBitmap, 0, 0);\n    imageBitmap.close();\n    var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n    _this5.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n    toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n    // https://github.com/nodeca/pica/issues/199\n\n    tmpCanvas.width = tmpCanvas.height = 0;\n    iData = tmpCtx = tmpCanvas = toCtx = null;\n\n    _this5.debug('Finished!');\n\n    return to;\n  });\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this6 = this;\n\n  this.debug('Start resize...');\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, {\n      quality: options\n    });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height; // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  } // Prevent stepper from infinite loop\n\n\n  if (to.width === 0 || to.height === 0) {\n    return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n  }\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n  opts.canceled = false;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    opts.cancelToken = opts.cancelToken.then(function (data) {\n      opts.canceled = true;\n      throw data;\n    }, function (err) {\n      opts.canceled = true;\n      throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n  opts.__destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n  return this.init().then(function () {\n    if (opts.canceled) return opts.cancelToken; // if createImageBitmap supports resize, just do it and return\n\n    if (_this6.features.cib) {\n      if (filter_info.q2f.indexOf(opts.filter) >= 0) {\n        return _this6.__resizeViaCreateImageBitmap(from, to, opts);\n      }\n\n      _this6.debug('cib is enabled, but not supports provided filter, fallback to manual math');\n    }\n\n    if (!CAN_USE_CANVAS_GET_IMAGE_DATA) {\n      var err = new Error('Pica: cannot use getImageData on canvas, ' + \"make sure fingerprinting protection isn't enabled\");\n      err.code = 'ERR_GET_IMAGE_DATA';\n      throw err;\n    } //\n    // No easy way, let's resize manually via arrays\n    //\n\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this6.options.tile, opts.__destTileBorder);\n    return _this6.__processStages(stages, from, to, opts);\n  });\n}; // RGBA buffer resize\n//\n\n\nPica.prototype.resizeBuffer = function (options) {\n  var _this7 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options); // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  }\n\n  return this.init().then(function () {\n    return _this7.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    if (canvas.convertToBlob) {\n      resolve(canvas.convertToBlob({\n        type: mimeType,\n        quality: quality\n      }));\n      return;\n    } // Fallback for old browsers\n\n\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], {\n      type: mimeType\n    }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/mm_resize/resize_filter_info\":7,\"./lib/pool\":13,\"./lib/stepper\":14,\"./lib/tiler\":15,\"./lib/utils\":16,\"./lib/worker\":17,\"object-assign\":22,\"webworkify\":23}]},{},[])(\"/index.js\")\n});\n}(pica$1));\n\nvar jpeg_plugins = {};\n\nvar image_traverse$1 = {exports: {}};\n\n(function (module) {\n\n//////////////////////////////////////////////////////////////////////////\n// Helpers\n//\nfunction error(message, code) {\n  var err = new Error(message);\n  err.code = code;\n  return err;\n}\n\n\n// Convert number to 0xHH string\n//\nfunction to_hex(number) {\n  var n = number.toString(16).toUpperCase();\n  for (var i = 2 - n.length; i > 0; i--) n = '0' + n;\n  return '0x' + n;\n}\n\n\nfunction utf8_encode(str) {\n  try {\n    return unescape(encodeURIComponent(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\nfunction utf8_decode(str) {\n  try {\n    return decodeURIComponent(escape(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\n// Check if input is a Uint8Array\n//\nfunction is_uint8array(bin) {\n  return Object.prototype.toString.call(bin) === '[object Uint8Array]';\n}\n\n\n//////////////////////////////////////////////////////////////////////////\n// Exif parser\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - exif_start: Number     - start of TIFF header (after Exif\\0\\0)\n//  - exif_end:   Number     - end of Exif segment\n//  - on_entry:   Number     - callback\n//\nfunction ExifParser(jpeg_bin, exif_start, exif_end) {\n  // Uint8Array, exif without signature (which isn't included in offsets)\n  this.input      = jpeg_bin.subarray(exif_start, exif_end);\n\n  // offset correction for `on_entry` callback\n  this.start      = exif_start;\n\n  // Check TIFF header (includes byte alignment and first IFD offset)\n  var sig = String.fromCharCode.apply(null, this.input.subarray(0, 4));\n\n  if (sig !== 'II\\x2A\\0' && sig !== 'MM\\0\\x2A') {\n    throw error('invalid TIFF signature', 'EBADDATA');\n  }\n\n  // true if motorola (big endian) byte alignment, false if intel\n  this.big_endian = sig[0] === 'M';\n}\n\n\nExifParser.prototype.each = function (on_entry) {\n  // allow premature exit\n  this.aborted = false;\n\n  var offset = this.read_uint32(4);\n\n  this.ifds_to_read = [ {\n    id:     0,\n    offset: offset\n  } ];\n\n  while (this.ifds_to_read.length > 0 && !this.aborted) {\n    var i = this.ifds_to_read.shift();\n    if (!i.offset) continue;\n    this.scan_ifd(i.id, i.offset, on_entry);\n  }\n};\n\n\nExifParser.prototype.filter = function (on_entry) {\n  var ifds = {};\n\n  // make sure IFD0 always exists\n  ifds.ifd0 = { id: 0, entries: [] };\n\n  this.each(function (entry) {\n    if (on_entry(entry) === false && !entry.is_subifd_link) return;\n    if (entry.is_subifd_link && entry.count !== 1 && entry.format !== 4) return; // filter out bogus links\n\n    if (!ifds['ifd' + entry.ifd]) {\n      ifds['ifd' + entry.ifd] = { id: entry.ifd, entries: [] };\n    }\n\n    ifds['ifd' + entry.ifd].entries.push(entry);\n  });\n\n  // thumbnails are not supported just yet, so delete all information related to it\n  delete ifds.ifd1;\n\n  // Calculate output size\n  var length = 8;\n  Object.keys(ifds).forEach(function (ifd_no) {\n    length += 2;\n\n    ifds[ifd_no].entries.forEach(function (entry) {\n      length += 12 + (entry.data_length > 4 ? Math.ceil(entry.data_length / 2) * 2 : 0);\n    });\n\n    length += 4;\n  });\n\n  this.output = new Uint8Array(length);\n  this.output[0] = this.output[1] = (this.big_endian ? 'M' : 'I').charCodeAt(0);\n  this.write_uint16(2, 0x2A);\n\n  var offset = 8;\n  var self = this;\n  this.write_uint32(4, offset);\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    ifds[ifd_no].written_offset = offset;\n\n    var ifd_start = offset;\n    var ifd_end   = ifd_start + 2 + ifds[ifd_no].entries.length * 12 + 4;\n    offset = ifd_end;\n\n    self.write_uint16(ifd_start, ifds[ifd_no].entries.length);\n\n    ifds[ifd_no].entries.sort(function (a, b) {\n      // IFD entries must be in order of increasing tag IDs\n      return a.tag - b.tag;\n    }).forEach(function (entry, idx) {\n      var entry_offset = ifd_start + 2 + idx * 12;\n\n      self.write_uint16(entry_offset, entry.tag);\n      self.write_uint16(entry_offset + 2, entry.format);\n      self.write_uint32(entry_offset + 4, entry.count);\n\n      if (entry.is_subifd_link) {\n        // filled in later\n        if (ifds['ifd' + entry.tag]) ifds['ifd' + entry.tag].link_offset = entry_offset + 8;\n      } else if (entry.data_length <= 4) {\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + 4),\n          entry_offset + 8\n        );\n      } else {\n        self.write_uint32(entry_offset + 8, offset);\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + entry.data_length),\n          offset\n        );\n        offset += Math.ceil(entry.data_length / 2) * 2;\n      }\n    });\n\n    var next_ifd = ifds['ifd' + (ifds[ifd_no].id + 1)];\n    if (next_ifd) next_ifd.link_offset = ifd_end - 4;\n  });\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    if (ifds[ifd_no].written_offset && ifds[ifd_no].link_offset) {\n      self.write_uint32(ifds[ifd_no].link_offset, ifds[ifd_no].written_offset);\n    }\n  });\n\n  if (this.output.length !== offset) throw error('internal error: incorrect buffer size allocated');\n\n  return this.output;\n};\n\n\nExifParser.prototype.read_uint16 = function (offset) {\n  var d = this.input;\n  if (offset + 2 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x100 + d[offset + 1] :\n    d[offset] + d[offset + 1] * 0x100;\n};\n\n\nExifParser.prototype.read_uint32 = function (offset) {\n  var d = this.input;\n  if (offset + 4 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x1000000 + d[offset + 1] * 0x10000 + d[offset + 2] * 0x100 + d[offset + 3] :\n    d[offset] + d[offset + 1] * 0x100 + d[offset + 2] * 0x10000 + d[offset + 3] * 0x1000000;\n};\n\n\nExifParser.prototype.write_uint16 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 8) & 0xFF;\n    d[offset + 1] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.write_uint32 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 24) & 0xFF;\n    d[offset + 1] = (value >>> 16) & 0xFF;\n    d[offset + 2] = (value >>> 8) & 0xFF;\n    d[offset + 3] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n    d[offset + 2] = (value >>> 16) & 0xFF;\n    d[offset + 3] = (value >>> 24) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.is_subifd_link = function (ifd, tag) {\n  return (ifd === 0 && tag === 0x8769) || // SubIFD\n         (ifd === 0 && tag === 0x8825) || // GPS Info\n         (ifd === 0x8769 && tag === 0xA005); // Interop IFD\n};\n\n\n// Returns byte length of a single component of a given format\n//\nExifParser.prototype.exif_format_length = function (format) {\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n    case 6: // sbyte\n    case 7: // undefined\n      return 1;\n\n    case 3: // short\n    case 8: // sshort\n      return 2;\n\n    case 4:  // long\n    case 9:  // slong\n    case 11: // float\n      return 4;\n\n    case 5:  // rational\n    case 10: // srational\n    case 12: // double\n      return 8;\n\n    default:\n      // unknown type\n      return 0;\n  }\n};\n\n\n// Reads Exif data\n//\nExifParser.prototype.exif_format_read = function (format, offset) {\n  var v;\n\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n      v = this.input[offset];\n      return v;\n\n    case 6: // sbyte\n      v = this.input[offset];\n      return v | (v & 0x80) * 0x1fffffe;\n\n    case 3: // short\n      v = this.read_uint16(offset);\n      return v;\n\n    case 8: // sshort\n      v = this.read_uint16(offset);\n      return v | (v & 0x8000) * 0x1fffe;\n\n    case 4: // long\n      v = this.read_uint32(offset);\n      return v;\n\n    case 9: // slong\n      v = this.read_uint32(offset);\n      return v | 0;\n\n    case 5:  // rational\n    case 10: // srational\n    case 11: // float\n    case 12: // double\n      return null; // not implemented\n\n    case 7: // undefined\n      return null; // blob\n\n    default:\n      // unknown type\n      return null;\n  }\n};\n\n\nExifParser.prototype.scan_ifd = function (ifd_no, offset, on_entry) {\n  var entry_count = this.read_uint16(offset);\n\n  offset += 2;\n\n  for (var i = 0; i < entry_count; i++) {\n    var tag    = this.read_uint16(offset);\n    var format = this.read_uint16(offset + 2);\n    var count  = this.read_uint32(offset + 4);\n\n    var comp_length    = this.exif_format_length(format);\n    var data_length    = count * comp_length;\n    var data_offset    = data_length <= 4 ? offset + 8 : this.read_uint32(offset + 8);\n    var is_subifd_link = false;\n\n    if (data_offset + data_length > this.input.length) {\n      throw error('unexpected EOF', 'EBADDATA');\n    }\n\n    var value = [];\n    var comp_offset = data_offset;\n\n    for (var j = 0; j < count; j++, comp_offset += comp_length) {\n      var item = this.exif_format_read(format, comp_offset);\n      if (item === null) {\n        value = null;\n        break;\n      }\n      value.push(item);\n    }\n\n    if (Array.isArray(value) && format === 2) {\n      try {\n        value = utf8_decode(String.fromCharCode.apply(null, value));\n      } catch (_) {\n        value = null;\n      }\n\n      if (value && value[value.length - 1] === '\\0') value = value.slice(0, -1);\n    }\n\n    if (this.is_subifd_link(ifd_no, tag)) {\n      if (Array.isArray(value) && Number.isInteger(value[0]) && value[0] > 0) {\n        this.ifds_to_read.push({\n          id:     tag,\n          offset: value[0]\n        });\n        is_subifd_link = true;\n      }\n    }\n\n    var entry = {\n      is_big_endian:  this.big_endian,\n      ifd:            ifd_no,\n      tag:            tag,\n      format:         format,\n      count:          count,\n      entry_offset:   offset + this.start,\n      data_length:    data_length,\n      data_offset:    data_offset + this.start,\n      value:          value,\n      is_subifd_link: is_subifd_link\n    };\n\n    if (on_entry(entry) === false) {\n      this.aborted = true;\n      return;\n    }\n\n    offset += 12;\n  }\n\n  if (ifd_no === 0) {\n    this.ifds_to_read.push({\n      id:     1,\n      offset: this.read_uint32(offset)\n    });\n  }\n};\n\n\n// Check whether input is a JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//\n// Returns true if it is and false otherwise\n//\nmodule.exports.is_jpeg = function (jpeg_bin) {\n  return jpeg_bin.length >= 4 && jpeg_bin[0] === 0xFF && jpeg_bin[1] === 0xD8 && jpeg_bin[2] === 0xFF;\n};\n\n\n// Call an iterator on each segment in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// Iteration stops when `EOI` (0xFFD9) marker is reached or if `on_segment`\n// function returns `false`.\n//\nmodule.exports.jpeg_segments_each = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  if (!module.exports.is_jpeg(jpeg_bin)) {\n    throw error('Unknown file format', 'ENOTJPEG');\n  }\n\n  var offset = 0, length = jpeg_bin.length, inside_scan = false;\n\n  for (;;) {\n    var segment_code, segment_length;\n\n    if (offset + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n    var byte1 = jpeg_bin[offset];\n    var byte2 = jpeg_bin[offset + 1];\n\n    if (byte1 === 0xFF && byte2 === 0xFF) {\n      // padding\n      segment_code = 0xFF;\n      segment_length = 1;\n\n    } else if (byte1 === 0xFF && byte2 !== 0) {\n      // marker\n      segment_code = byte2;\n      segment_length = 2;\n\n      if ((0xD0 <= segment_code && segment_code <= 0xD9) || segment_code === 0x01) ; else {\n        if (offset + 3 >= length) throw error('Unexpected EOF', 'EBADDATA');\n        segment_length += jpeg_bin[offset + 2] * 0x100 + jpeg_bin[offset + 3];\n        if (segment_length < 2) throw error('Invalid segment length', 'EBADDATA');\n        if (offset + segment_length - 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n      }\n\n      if (inside_scan) {\n        if (segment_code >= 0xD0 && segment_code <= 0xD7) ; else {\n          inside_scan = false;\n        }\n      }\n\n      if (segment_code === 0xDA /* SOS */) inside_scan = true;\n    } else if (inside_scan) {\n      // entropy-encoded segment\n      for (var pos = offset + 1; ; pos++) {\n        // scan until we find FF\n        if (pos >= length) throw error('Unexpected EOF', 'EBADDATA');\n        if (jpeg_bin[pos] === 0xFF) {\n          if (pos + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n          if (jpeg_bin[pos + 1] !== 0) {\n            segment_code = 0;\n            segment_length = pos - offset;\n            break;\n          }\n        }\n      }\n    } else {\n      throw error('Unexpected byte at segment start: ' + to_hex(byte1) +\n        ' (offset ' + to_hex(offset) + ')', 'EBADDATA');\n    }\n\n    if (on_segment({ code: segment_code, offset: offset, length: segment_length }) === false) break;\n    if (segment_code === 0xD9 /* EOI */) break;\n    offset += segment_length;\n  }\n};\n\n\n// Replace or remove segments in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// `on_segment` function should return one of the following:\n//  - `false`        - segment is removed from the output\n//  - Uint8Array     - segment is replaced with the new data\n//  - [ Uint8Array ] - segment is replaced with the new data\n//  - anything else  - segment is copied to the output as is\n//\n// Any data after `EOI` (0xFFD9) marker is removed.\n//\nmodule.exports.jpeg_segments_filter = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  var ranges = [];\n  var out_length = 0;\n\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    var new_segment = on_segment(segment);\n\n    if (is_uint8array(new_segment)) {\n      ranges.push({ data: new_segment });\n      out_length += new_segment.length;\n    } else if (Array.isArray(new_segment)) {\n      new_segment.filter(is_uint8array).forEach(function (s) {\n        ranges.push({ data: s });\n        out_length += s.length;\n      });\n    } else if (new_segment !== false) {\n      var new_range = { start: segment.offset, end: segment.offset + segment.length };\n\n      if (ranges.length > 0 && ranges[ranges.length - 1].end === new_range.start) {\n        ranges[ranges.length - 1].end = new_range.end;\n      } else {\n        ranges.push(new_range);\n      }\n\n      out_length += segment.length;\n    }\n  });\n\n  var result = new Uint8Array(out_length);\n  var offset = 0;\n\n  ranges.forEach(function (range) {\n    var data = range.data || jpeg_bin.subarray(range.start, range.end);\n    result.set(data, offset);\n    offset += data.length;\n  });\n\n  return result;\n};\n\n\n// Call an iterator on each Exif entry in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                 0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                 (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// Iteration stops early if iterator returns `false`.\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed.\n//\nmodule.exports.jpeg_exif_tags_each = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  /* eslint-disable consistent-return */\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    if (segment.code === 0xDA /* SOS */) return false;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length).each(on_exif_entry);\n      return false;\n    }\n  });\n};\n\n\n// Remove Exif entries in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                  0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                  (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// This function removes following from Exif:\n//  - all entries where iterator returned false (except subifd links which are mandatory)\n//  - IFD1 and thumbnail image (the purpose of this function is to reduce file size,\n//    so thumbnail is usually the first thing to go)\n//  - all other data that isn't in IFD0, SubIFD, GPSIFD, InteropIFD\n//    (theoretically possible proprietary extensions, I haven't seen any of these yet)\n//\n// Changing data inside Exif entries is NOT supported yet (modifying `entry` object inside callback may break stuff).\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed, and original JPEG is returned as is.\n//\nmodule.exports.jpeg_exif_tags_filter = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  var stop_search = false;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    if (stop_search) return;\n    if (segment.code === 0xDA /* SOS */) stop_search = true;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      var new_exif = new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length)\n        .filter(on_exif_entry);\n      if (!new_exif) return false;\n\n      var header = new Uint8Array(10);\n\n      header.set(jpeg_bin.slice(segment.offset, segment.offset + 10));\n      header[2] = ((new_exif.length + 8) >>> 8) & 0xFF;\n      header[3] = (new_exif.length + 8) & 0xFF;\n\n      stop_search = true;\n      return [ header, new_exif ];\n    }\n  });\n};\n\n\n// Inserts a custom comment marker segment into JPEG file.\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - comment:  String\n//\n// Comment is inserted after first two bytes (FFD8, SOI).\n//\n// If JFIF (APP0) marker exists immediately after SOI (as mandated by the JFIF\n// spec), we insert comment after it instead.\n//\nmodule.exports.jpeg_add_comment = function (jpeg_bin, comment) {\n  var comment_inserted = false, segment_count = 0;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    segment_count++;\n    if (segment_count === 1 && segment.code === 0xD8 /* SOI  */) return;\n    if (segment_count === 2 && segment.code === 0xE0 /* APP0 */) return;\n\n    if (comment_inserted) return;\n    comment = utf8_encode(comment);\n\n    // comment segment\n    var csegment = new Uint8Array(5 + comment.length);\n    var offset = 0;\n\n    csegment[offset++] = 0xFF;\n    csegment[offset++] = 0xFE;\n    csegment[offset++] = ((comment.length + 3) >>> 8) & 0xFF;\n    csegment[offset++] = (comment.length + 3) & 0xFF;\n\n    comment.split('').forEach(function (c) {\n      csegment[offset++] = c.charCodeAt(0) & 0xFF;\n    });\n\n    csegment[offset++] = 0;\n    comment_inserted = true;\n\n    return [ csegment, jpeg_bin.subarray(segment.offset, segment.offset + segment.length) ];\n  });\n};\n}(image_traverse$1));\n\nvar image_traverse = image_traverse$1.exports;\n\n\nfunction jpeg_patch_exif(env) {\n  return this._getUint8Array(env.blob).then(function (data) {\n    env.is_jpeg = image_traverse.is_jpeg(data);\n\n    if (!env.is_jpeg) return Promise.resolve(env);\n\n    env.orig_blob = env.blob;\n\n    try {\n      var exif_is_big_endian, orientation_offset;\n\n      /* eslint-disable consistent-return */\n      image_traverse.jpeg_exif_tags_each(data, function (entry) {\n        if (entry.ifd === 0 && entry.tag === 0x112 && Array.isArray(entry.value)) {\n          env.orientation    = entry.value[0] || 1;\n          exif_is_big_endian = entry.is_big_endian;\n          orientation_offset = entry.data_offset;\n          return false;\n        }\n      });\n\n      if (orientation_offset) {\n        var orientation_patch = exif_is_big_endian ?\n          new Uint8Array([ 0, 1 ]) :\n          new Uint8Array([ 1, 0 ]);\n\n        env.blob = new Blob([\n          data.slice(0, orientation_offset),\n          orientation_patch,\n          data.slice(orientation_offset + 2)\n        ], { type: 'image/jpeg' });\n      }\n    } catch (_) {}\n\n    return env;\n  });\n}\n\n\nfunction jpeg_rotate_canvas(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  var orientation = env.orientation - 1;\n  if (!orientation) return Promise.resolve(env);\n\n  var canvas;\n\n  if (orientation & 4) {\n    canvas = this.pica.options.createCanvas(env.out_canvas.height, env.out_canvas.width);\n  } else {\n    canvas = this.pica.options.createCanvas(env.out_canvas.width, env.out_canvas.height);\n  }\n\n  var ctx = canvas.getContext('2d');\n\n  ctx.save();\n\n  if (orientation & 1) ctx.transform(-1, 0, 0, 1, canvas.width, 0);\n  if (orientation & 2) ctx.transform(-1, 0, 0, -1, canvas.width, canvas.height);\n  if (orientation & 4) ctx.transform(0, 1, 1, 0, 0, 0);\n\n  ctx.drawImage(env.out_canvas, 0, 0);\n  ctx.restore();\n\n  // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n  env.out_canvas.width = env.out_canvas.height = 0;\n\n  env.out_canvas = canvas;\n\n  return Promise.resolve(env);\n}\n\n\nfunction jpeg_attach_orig_segments(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  return Promise.all([\n    this._getUint8Array(env.blob),\n    this._getUint8Array(env.out_blob)\n  ]).then(function (res) {\n    var data = res[0];\n    var data_out = res[1];\n\n    if (!image_traverse.is_jpeg(data)) return Promise.resolve(env);\n\n    var segments = [];\n\n    image_traverse.jpeg_segments_each(data, function (segment) {\n      if (segment.code === 0xDA /* SOS */) return false;\n      segments.push(segment);\n    });\n\n    segments = segments\n      .filter(function (segment) {\n        // Drop ICC_PROFILE\n        //\n        if (segment.code === 0xE2) return false;\n\n        // Keep all APPn segments excluding APP2 (ICC_PROFILE),\n        // remove others because most of them depend on image data (DCT and such).\n        //\n        // APP0 - JFIF, APP1 - Exif, the rest are photoshop metadata and such\n        //\n        // See full list at https://www.w3.org/Graphics/JPEG/itu-t81.pdf (table B.1 on page 32)\n        //\n        if (segment.code >= 0xE0 && segment.code < 0xF0) return true;\n\n        // Keep comments\n        //\n        if (segment.code === 0xFE) return true;\n\n        return false;\n      })\n      .map(function (segment) {\n        return data.slice(segment.offset, segment.offset + segment.length);\n      });\n\n    env.out_blob = new Blob(\n      // intentionally omitting expected JFIF segment (offset 2 to 20)\n      [ data_out.slice(0, 2) ].concat(segments).concat([ data_out.slice(20) ]),\n      { type: 'image/jpeg' }\n    );\n\n    return env;\n  });\n}\n\n\nfunction assign(reducer) {\n  reducer.before('_blob_to_image', jpeg_patch_exif);\n  reducer.after('_transform',      jpeg_rotate_canvas);\n  reducer.after('_create_blob',    jpeg_attach_orig_segments);\n}\n\n\njpeg_plugins.jpeg_patch_exif = jpeg_patch_exif;\njpeg_plugins.jpeg_rotate_canvas = jpeg_rotate_canvas;\njpeg_plugins.jpeg_attach_orig_segments = jpeg_attach_orig_segments;\njpeg_plugins.assign = assign;\n\nvar utils = utils$1;\nvar pica  = pica$1.exports;\n\nfunction ImageBlobReduce(options) {\n  if (!(this instanceof ImageBlobReduce)) return new ImageBlobReduce(options);\n\n  options = options || {};\n\n  this.pica = options.pica || pica({});\n  this.initialized = false;\n\n  this.utils = utils;\n}\n\n\nImageBlobReduce.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\nImageBlobReduce.prototype.init = function () {\n  this.use(jpeg_plugins.assign);\n};\n\n\nImageBlobReduce.prototype.toBlob = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(this._create_blob)\n    .then(function (_env) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      _env.out_canvas.width = _env.out_canvas.height = 0;\n\n      return _env.out_blob;\n    });\n};\n\n\nImageBlobReduce.prototype.toCanvas = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(function (_env) { return _env.out_canvas; });\n};\n\n\nImageBlobReduce.prototype.before = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return fn.call(self, env).then(function (_env) {\n      return old_fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype.after = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return old_fn.call(self, env).then(function (_env) {\n      return fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype._blob_to_image = function (env) {\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n  env.image = document.createElement('img');\n  env.image_url = URL.createObjectURL(env.blob);\n  env.image.src = env.image_url;\n\n  return new Promise(function (resolve, reject) {\n    env.image.onerror = function () { reject(new Error('ImageBlobReduce: failed to create Image() from blob')); };\n    env.image.onload = function () { resolve(env); };\n  });\n};\n\n\nImageBlobReduce.prototype._calculate_size = function (env) {\n  //\n  // Note, if your need not \"symmetric\" resize logic, you MUST check\n  // `env.orientation` (set by plugins) and swap width/height appropriately.\n  //\n  var scale_factor = env.opts.max / Math.max(env.image.width, env.image.height);\n\n  if (scale_factor > 1) scale_factor = 1;\n\n  env.transform_width = Math.max(Math.round(env.image.width * scale_factor), 1);\n  env.transform_height = Math.max(Math.round(env.image.height * scale_factor), 1);\n\n  // Info for user plugins, to check if scaling applied\n  env.scale_factor = scale_factor;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._transform = function (env) {\n  env.out_canvas = this.pica.options.createCanvas(env.transform_width, env.transform_height);\n\n  // Dim env temporary vars to prohibit use and avoid confusion when orientation\n  // changed. You should take real size from canvas.\n  env.transform_width = null;\n  env.transform_height = null;\n\n  // By default use alpha for png only\n  var pica_opts = { alpha: env.blob.type === 'image/png' };\n\n  // Extract pica options if been passed\n  this.utils.assign(pica_opts, this.utils.pick_pica_resize_options(env.opts));\n\n  return this.pica\n    .resize(env.image, env.out_canvas, pica_opts)\n    .then(function () { return env; });\n};\n\n\nImageBlobReduce.prototype._cleanup = function (env) {\n  env.image.src = '';\n  env.image = null;\n\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n  if (URL.revokeObjectURL) URL.revokeObjectURL(env.image_url);\n\n  env.image_url = null;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._create_blob = function (env) {\n  return this.pica.toBlob(env.out_canvas, env.blob.type)\n    .then(function (blob) {\n      env.out_blob = blob;\n      return env;\n    });\n};\n\n\nImageBlobReduce.prototype._getUint8Array = function (blob) {\n  if (blob.arrayBuffer) {\n    return blob.arrayBuffer().then(function (buf) {\n      return new Uint8Array(buf);\n    });\n  }\n\n  return new Promise(function (resolve, reject) {\n    var fr = new FileReader();\n\n    fr.readAsArrayBuffer(blob);\n\n    fr.onload = function () { resolve(new Uint8Array(fr.result)); };\n    fr.onerror = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob'));\n      fr.abort();\n    };\n    fr.onabort = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob (aborted)'));\n    };\n  });\n};\n\n\nImageBlobReduce.pica = pica;\n\nvar imageBlobReduce = ImageBlobReduce;\n\nexport { imageBlobReduce as default };\n"],"names":["module","exports","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","obj","Symbol","iterator","constructor","prototype","_defineProperties","props","descriptor","configurable","writable","value","_toConsumableArray","arr","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","iter","from","_iterableToArray","o","minLen","n","toString","call","slice","name","test","_unsupportedIterableToArray","TypeError","_nonIterableSpread","len","arr2","IS_BROWSER","window","document","WINDOW","IS_TOUCH_DEVICE","documentElement","HAS_POINTER_EVENT","NAMESPACE","ACTION_ALL","ACTION_CROP","ACTION_MOVE","ACTION_ZOOM","ACTION_EAST","ACTION_WEST","ACTION_SOUTH","ACTION_NORTH","ACTION_NORTH_EAST","ACTION_NORTH_WEST","ACTION_SOUTH_EAST","ACTION_SOUTH_WEST","CLASS_CROP","concat","CLASS_DISABLED","CLASS_HIDDEN","CLASS_HIDE","CLASS_INVISIBLE","CLASS_MODAL","CLASS_MOVE","DATA_ACTION","DATA_PREVIEW","DRAG_MODE_CROP","DRAG_MODE_MOVE","DRAG_MODE_NONE","EVENT_CROP","EVENT_CROP_END","EVENT_CROP_MOVE","EVENT_CROP_START","EVENT_DBLCLICK","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_READY","EVENT_RESIZE","EVENT_WHEEL","EVENT_ZOOM","MIME_TYPE_JPEG","REGEXP_ACTIONS","REGEXP_DATA_URL","REGEXP_DATA_URL_JPEG","REGEXP_TAG_NAME","DEFAULTS","viewMode","dragMode","initialAspectRatio","NaN","aspectRatio","data","preview","responsive","restore","checkCrossOrigin","checkOrientation","modal","guides","center","highlight","background","autoCrop","autoCropArea","movable","rotatable","scalable","zoomable","zoomOnTouch","zoomOnWheel","wheelZoomRatio","cropBoxMovable","cropBoxResizable","toggleDragModeOnDblclick","minCanvasWidth","minCanvasHeight","minCropBoxWidth","minCropBoxHeight","minContainerWidth","minContainerHeight","ready","cropstart","cropmove","cropend","crop","zoom","isNaN","Number","isNumber","isPositiveNumber","Infinity","isUndefined","isObject","hasOwnProperty","isPlainObject","_constructor","error","isFunction","toArray","callback","assign","_len","args","_key","arg","REGEXP_DECIMALS","normalizeDecimalNumber","times","undefined","Math","round","REGEXP_SUFFIX","setStyle","element","styles","style","property","addClass","elem","classList","add","className","trim","indexOf","removeClass","remove","replace","toggleClass","added","REGEXP_CAMEL_CASE","toParamCase","toLowerCase","getData","dataset","getAttribute","setData","setAttribute","REGEXP_SPACES","onceSupported","supported","once","listener","options","get","set","addEventListener","removeEventListener","removeListener","type","handler","split","event","listeners","addListener","_handler","_element$listeners","_len2","_key2","dispatchEvent","Event","CustomEvent","detail","bubbles","cancelable","createEvent","initCustomEvent","getOffset","box","getBoundingClientRect","left","pageXOffset","clientLeft","top","pageYOffset","clientTop","location","REGEXP_ORIGINS","isCrossOriginURL","url","parts","match","protocol","hostname","port","addTimestamp","timestamp","Date","getTime","getTransforms","_ref","rotate","scaleX","scaleY","translateX","translateY","values","transform","join","WebkitTransform","msTransform","getPointer","_ref2","endOnly","pageX","pageY","end","endX","endY","startX","startY","getAdjustedSizes","_ref4","height","width","isValidWidth","isValidHeight","adjustedWidth","fromCharCode","String","REGEXP_DATA_URL_HEAD","resetAndGetOrientation","arrayBuffer","orientation","dataView","DataView","littleEndian","app1Start","ifdStart","getUint8","byteLength","offset","tiffOffset","start","str","getStringFromCharCode","endianness","getUint16","firstIFDOffset","getUint32","_offset","_length","setUint16","render","this","initContainer","initCanvas","initCropBox","renderCanvas","cropped","renderCropBox","container","cropper","minWidth","minHeight","containerData","max","offsetWidth","offsetHeight","imageData","rotated","abs","naturalWidth","naturalHeight","canvasWidth","canvasHeight","canvasData","limited","limitCanvas","min","maxWidth","maxHeight","oldLeft","oldTop","initialCanvasData","sizeLimited","positionLimited","cropBoxData","_getAdjustedSizes","newCanvasLeft","newCanvasTop","minLeft","minTop","maxLeft","maxTop","changed","transformed","_getRotatedSizes","_ref5","degree","arc","PI","sinArc","sin","cosArc","cos","newWidth","newHeight","getRotatedSizes","canvas","renderImage","limitCropBox","image","output","initialCropBoxData","maxCropBoxWidth","maxCropBoxHeight","face","cropBox","disabled","initPreview","crossOrigin","crossOriginUrl","alt","createElement","src","viewBox","appendChild","viewBoxImage","previews","ownerDocument","querySelectorAll","querySelector","el","img","html","innerHTML","cssText","resetPreview","removeAttribute","removeData","cropBoxWidth","cropBoxHeight","originalWidth","originalHeight","ratio","getElementsByTagName","events","bind","onCropStart","cropStart","onWheel","wheel","passive","capture","onDblclick","dblclick","onCropMove","cropMove","onCropEnd","cropEnd","onResize","resize","unbind","handlers","ratioX","ratioY","getCanvasData","getCropBoxData","setCanvasData","setCropBoxData","setDragMode","dragBox","contains","_this","delta","preventDefault","wheeling","setTimeout","deltaY","wheelDelta","buttons","button","pointerType","ctrlKey","action","pointers","changedTouches","touch","identifier","pointerId","originalEvent","cropping","change","right","bottom","renderable","shiftKey","pointer","range","x","y","check","side","move","pointers2","maxRatio","pointer2","x1","y1","x2","y2","z1","sqrt","getMaxZoomRatio","p","methods","reset","initialImageData","clear","hasSameSize","isImg","replaced","uncreate","load","enable","disable","destroy","originalUrl","offsetX","offsetY","_this$canvasData","moveTo","_originalEvent","zoomTo","pivot","oldRatio","count","_ref3","getPointersCenter","rotateTo","_scaleX","scale","_scaleY","rounded","getContainerData","getImageData","sized","widthChanged","heightChanged","getCroppedCanvas","HTMLCanvasElement","_ref6","_ref7","_ref8","imageAspectRatio","imageNaturalWidth","imageNaturalHeight","_ref6$rotate","_ref6$scaleX","_ref6$scaleY","_ref8$fillColor","fillColor","_ref8$imageSmoothingE","imageSmoothingEnabled","_ref8$imageSmoothingQ","imageSmoothingQuality","_ref8$maxWidth","_ref8$maxHeight","_ref8$minWidth","_ref8$minHeight","context","getContext","maxSizes","minSizes","destMaxSizes","destMinSizes","destWidth","destHeight","params","fillStyle","fillRect","save","translate","drawImage","map","param","floor","getSourceCanvas","_this$getData","initialX","initialY","initialWidth","initialHeight","_options$imageSmoothi","srcWidth","srcHeight","dstX","dstY","dstWidth","dstHeight","sourceWidth","sourceHeight","srcX","srcY","setAspectRatio","mode","croppable","AnotherCropper","Cropper","instance","Constructor","_classCallCheck","tagName","Error","reloading","sizing","init","staticProps","protoProps","toDataURL","base64","binary","uint8","ArrayBuffer","read","atob","Uint8Array","charCodeAt","clone","xhr","XMLHttpRequest","onabort","onerror","ontimeout","onprogress","getResponseHeader","abort","onload","response","onloadend","open","responseType","withCredentials","send","mimeType","chunks","subarray","btoa","arrayBufferToDataURL","_parseOrientation","parseOrientation","stop","parentNode","insertBefore","nextSibling","_this2","isIOSWebKit","navigator","userAgent","done","build","sizingImage","body","removeChild","template","getElementsByClassName","unbuild","factory","commonjsRequire","path","utils$1","pick","to","s","pick_pica_resize_options","pica$1","r","e","t","f","u","a","code","_dereq_","Multimath","mm_unsharp_mask","mm_resize","MathLib","requested_features","__requested_features","features","js","wasm","has_wasm","use","create","resizeAndUnsharp","cache","result","unsharpAmount","unsharp_mask","toWidth","toHeight","unsharpRadius","unsharpThreshold","clampTo8","clampNegative","convolveHor","dest","srcW","srcH","destW","filters","g","b","filterPtr","filterShift","filterSize","srcPtr","destX","filterVal","srcOffset","destOffset","convolveVert","convolveHorWithPre","alpha","convolveVertWithPre","fn","wasm_fn","wasm_src","createFilters","_require","destH","filtersX","filtersY","tmp","Uint16Array","ptr","hasAlpha","dst","resetAlpha","FILTER_INFO","toFixedPoint","num","srcSize","destSize","destPixel","srcPixel","srcFirst","srcLast","filterElementSize","floatFilter","fxpFilter","total","pxl","idx","floatVal","filterTotal","leftNotEmpty","rightNotEmpty","filterFunction","scaleInverted","scaleClamped","srcWindow","win","maxFilterElementSize","packedFilter","Int16Array","packedFilterPtr","slowCopy","ceil","Float32Array","hamming","xpi","lanczos2","lanczos3","mks2013","f2q","q2f","IS_LE","Uint32Array","buffer","__","copyInt16asLE","target_offset","asUint8Array","src_size","tmp_offset","__align","tmp_size","filtersX_offset","filtersY_offset","alloc_bytes","__instance","mem","__memory","mem32","src32","convolveHV","_convolveHV","glur_mono16","amount","radius","threshold","v1","v2","vmul","diff","iTimes4","brightness","size","out","hsv_v16","blured","amountFp","thresholdFp","pixels","img_bytes_cnt","hsv_bytes_cnt","blur_bytes_cnt","blur_line_byte_cnt","hsv_offset","blur_offset","blur_tmp_offset","blur_line_offset","blur_coeffs_offset","exp","img32","_hsv_v16","blurMono16","_blurMono16","unsharp","_unsharp","Pool","idle","available","acquired","lastId","timeoutId","acquire","resource","pop","id","release","lastUsed","now","gc","_this3","fromWidth","fromHeight","srcTileSize","destTileBorder","minScale","stageCount","log","pow","PIXEL_EPSILON","pixelFloor","nearest","pixelCeil","innerX","innerY","toTileWidth","toTileHeight","innerTileWidth","innerTileHeight","tile","tiles","toX","toY","toInnerX","toInnerY","toInnerWidth","toInnerHeight","objClass","isCanvas","cname","isImage","isImageBitmap","limiter","concurrency","active","queue","roll","shift","Promise","resolve","reject","then","err","cib_quality_name","cib_support","createCanvas","createImageBitmap","c","resizeWidth","resizeHeight","resizeQuality","bitmap","status","close","worker_offscreen_canvas_support","OffscreenCanvas","self","rect","postMessage","w","Worker","onmessage","ev","can_use_canvas","usable","ctx","d","createImageData","putImageData","cib_can_use_region","Image","mathLib","tileOpts","opts","srcBitmap","a0","a1","a2","a3","b1","b2","convolveMono16","line","coeff","prev_src","curr_src","curr_out","prev_out","prev_prev_out","src_index","out_index","line_index","j","coeff_a0","coeff_a1","coeff_b1","coeff_b2","tmp_line","sigma","g1","g2","k","gaussCoef","base64decode","hasWebAssembly","DEFAULT_OPTIONS","MultiMath","__cache","__init_promise","__modules","modules","__wasm","__isLE","all","WebAssembly","compile","__base64decode","m","__reallocate","bytes","Memory","initial","mem_size","grow","memsize","env_extra","Module","env_base","memoryBase","memory","tableBase","table","Table","Instance","env","number","base","reminder","input","bits","charAt","tailbits","wa","bin","propIsEnumerable","propertyIsEnumerable","test1","getOwnPropertyNames","test2","test3","letter","shouldUseNative","val","toObject","bundleFn","sources","stringify","JSON","wkey","cacheKeys","l","default","random","wcache","skey","scache","workerSources","resolveSources","depPath","depKey","URL","webkitURL","mozURL","msURL","blob","Blob","bare","workerUrl","createObjectURL","worker","objectURL","_slicedToArray","_arrayWithHoles","_i","_s","_e","_arr","_n","_d","next","_iterableToArrayLimit","_nonIterableRest","webworkify","utils","createStages","createRegions","filter_info","singletones","NEED_SAFARI_FIX","hardwareConcurrency","DEFAULT_PICA_OPTS","tmpCanvas","DEFAULT_RESIZE_OPTS","CAN_NEW_IMAGE_DATA","CAN_CREATE_IMAGE_BITMAP","CAN_USE_CANVAS_GET_IMAGE_DATA","CAN_USE_OFFSCREEN_CANVAS","CAN_USE_CIB_REGION_FOR_IMAGE","workerFabric","terminate","revokeObjectURL","Pica","limiter_key","__limit","cib","ww","__workersPool","__mathlib","__initPromise","ImageData","Uint8ClampedArray","ImageBitmap","debug","wpool_key","checkCibResize","checkOffscreenCanvas","initMath","mathlib","checkCibRegion","__invokeResize","__mathCache","cancelToken","transfer","preload","wasm_nodule","__extractTileData","stageEnv","extractTo","srcImageBitmap","srcCtx","tmpCtx","globalCompositeOperation","__landTileData","toImageData","toCtx","__tileAndResize","isImageBitmapReused","imageBitmap","canceled","jobs","__destTileBorder","srcImageData","processTile","cleanup","__processStages","stages","_this4","_stages$shift2","isLastStage","res","__resizeViaCreateImageBitmap","_this5","iData","_this6","quality","resizeBuffer","_this7","toBlob","convertToBlob","asString","asBuffer","jpeg_plugins","image_traverse$1","message","to_hex","toUpperCase","utf8_decode","decodeURIComponent","escape","_","is_uint8array","ExifParser","jpeg_bin","exif_start","exif_end","sig","big_endian","each","on_entry","aborted","read_uint32","ifds_to_read","scan_ifd","ifds","entries","entry","is_subifd_link","format","ifd","ifd1","ifd_no","data_length","write_uint16","write_uint32","written_offset","ifd_start","ifd_end","sort","tag","entry_offset","link_offset","data_offset","next_ifd","read_uint16","exif_format_length","exif_format_read","v","entry_count","comp_length","comp_offset","item","isInteger","is_big_endian","is_jpeg","jpeg_segments_each","on_segment","inside_scan","segment_code","segment_length","byte1","byte2","pos","jpeg_segments_filter","ranges","out_length","segment","new_segment","new_range","jpeg_exif_tags_each","on_exif_entry","jpeg_exif_tags_filter","stop_search","new_exif","header","jpeg_add_comment","comment","comment_inserted","segment_count","unescape","encodeURIComponent","utf8_encode","csegment","image_traverse","jpeg_patch_exif","_getUint8Array","orig_blob","exif_is_big_endian","orientation_offset","orientation_patch","jpeg_rotate_canvas","pica","out_canvas","jpeg_attach_orig_segments","out_blob","data_out","segments","reducer","before","after","ImageBlobReduce","initialized","plugin","_blob_to_image","_calculate_size","_transform","_cleanup","_create_blob","_env","toCanvas","method_name","old_fn","image_url","scale_factor","transform_width","transform_height","pica_opts","buf","fr","FileReader","readAsArrayBuffer","imageBlobReduce"],"sourceRoot":""}